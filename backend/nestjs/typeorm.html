<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>TypeORM | é£è·ƒé«˜å±±ä¸å¤§æ´‹çš„é±¼</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="apple-touch-icon" href="/apple-touch-icon.png">
    <link rel="icon" href="/favicon.ico">
    <link rel="manifest" href="/manifest.json">
    <meta name="description" content="é£è·ƒé«˜å±±ä¸å¤§æ´‹çš„é±¼çš„æ–‡æ¡£, vuepress æ–‡æ¡£">
    <meta name="theme-color" content="#ffffff">
    <meta name="google-site-verification" content="Ld_AEWr30siza2LmmZ12csitRGsSj9gqqEAch0UXkTc">
    
    <link rel="preload" href="/assets/css/0.styles.e554653d.css" as="style"><link rel="preload" href="/assets/js/app.a7a57cfd.js" as="script"><link rel="preload" href="/assets/js/2.cc873f3c.js" as="script"><link rel="preload" href="/assets/js/36.e93c94a9.js" as="script"><link rel="preload" href="/assets/js/4.56440d0a.js" as="script"><link rel="prefetch" href="/assets/js/10.a0d20801.js"><link rel="prefetch" href="/assets/js/100.7402ae7a.js"><link rel="prefetch" href="/assets/js/101.25966556.js"><link rel="prefetch" href="/assets/js/102.57830e60.js"><link rel="prefetch" href="/assets/js/103.f1d1320f.js"><link rel="prefetch" href="/assets/js/104.3e1d4e09.js"><link rel="prefetch" href="/assets/js/105.846c88fb.js"><link rel="prefetch" href="/assets/js/106.760408dd.js"><link rel="prefetch" href="/assets/js/107.8ba78d50.js"><link rel="prefetch" href="/assets/js/108.74a7029e.js"><link rel="prefetch" href="/assets/js/109.d4352618.js"><link rel="prefetch" href="/assets/js/11.28807edd.js"><link rel="prefetch" href="/assets/js/110.3bdaca9c.js"><link rel="prefetch" href="/assets/js/111.25d0fa53.js"><link rel="prefetch" href="/assets/js/112.fed24a2c.js"><link rel="prefetch" href="/assets/js/113.b38c10bc.js"><link rel="prefetch" href="/assets/js/114.9d7f7958.js"><link rel="prefetch" href="/assets/js/115.cf72a713.js"><link rel="prefetch" href="/assets/js/116.3902723f.js"><link rel="prefetch" href="/assets/js/117.07aeddc3.js"><link rel="prefetch" href="/assets/js/118.b6e4467e.js"><link rel="prefetch" href="/assets/js/119.be455b86.js"><link rel="prefetch" href="/assets/js/12.6542aae9.js"><link rel="prefetch" href="/assets/js/120.3c4c2676.js"><link rel="prefetch" href="/assets/js/121.ebc555d3.js"><link rel="prefetch" href="/assets/js/122.c547123b.js"><link rel="prefetch" href="/assets/js/123.9a62881a.js"><link rel="prefetch" href="/assets/js/124.d33da008.js"><link rel="prefetch" href="/assets/js/125.f34955fe.js"><link rel="prefetch" href="/assets/js/126.f4ec1973.js"><link rel="prefetch" href="/assets/js/127.e27bc74d.js"><link rel="prefetch" href="/assets/js/128.775300fc.js"><link rel="prefetch" href="/assets/js/129.9e352053.js"><link rel="prefetch" href="/assets/js/13.96918e4f.js"><link rel="prefetch" href="/assets/js/130.32a831f0.js"><link rel="prefetch" href="/assets/js/131.ec020489.js"><link rel="prefetch" href="/assets/js/132.42166034.js"><link rel="prefetch" href="/assets/js/133.60b6c0c5.js"><link rel="prefetch" href="/assets/js/134.6bd133d3.js"><link rel="prefetch" href="/assets/js/135.513f7853.js"><link rel="prefetch" href="/assets/js/136.a56392f5.js"><link rel="prefetch" href="/assets/js/137.e99e0e46.js"><link rel="prefetch" href="/assets/js/138.0cbe3cb0.js"><link rel="prefetch" href="/assets/js/139.2c2487a2.js"><link rel="prefetch" href="/assets/js/14.57bcf19e.js"><link rel="prefetch" href="/assets/js/140.ec07504b.js"><link rel="prefetch" href="/assets/js/141.26c662b7.js"><link rel="prefetch" href="/assets/js/142.2bcc8db4.js"><link rel="prefetch" href="/assets/js/143.035ab929.js"><link rel="prefetch" href="/assets/js/144.1c3ae40f.js"><link rel="prefetch" href="/assets/js/145.4d597831.js"><link rel="prefetch" href="/assets/js/146.2aaaa1a8.js"><link rel="prefetch" href="/assets/js/147.2411fee2.js"><link rel="prefetch" href="/assets/js/148.00551d67.js"><link rel="prefetch" href="/assets/js/149.466893ea.js"><link rel="prefetch" href="/assets/js/15.4de3eaae.js"><link rel="prefetch" href="/assets/js/150.8aae638f.js"><link rel="prefetch" href="/assets/js/151.af75a74c.js"><link rel="prefetch" href="/assets/js/152.e112ab4c.js"><link rel="prefetch" href="/assets/js/153.6758593b.js"><link rel="prefetch" href="/assets/js/154.c6d533db.js"><link rel="prefetch" href="/assets/js/155.8700efa3.js"><link rel="prefetch" href="/assets/js/156.910e34c6.js"><link rel="prefetch" href="/assets/js/157.a9052904.js"><link rel="prefetch" href="/assets/js/158.71a8092e.js"><link rel="prefetch" href="/assets/js/159.ce6019b3.js"><link rel="prefetch" href="/assets/js/16.50414250.js"><link rel="prefetch" href="/assets/js/160.0f718c75.js"><link rel="prefetch" href="/assets/js/161.a15b0d87.js"><link rel="prefetch" href="/assets/js/162.473f7114.js"><link rel="prefetch" href="/assets/js/163.59423987.js"><link rel="prefetch" href="/assets/js/164.c1099b91.js"><link rel="prefetch" href="/assets/js/165.db4bdd99.js"><link rel="prefetch" href="/assets/js/166.95c8cad9.js"><link rel="prefetch" href="/assets/js/167.cb588999.js"><link rel="prefetch" href="/assets/js/168.12102a5a.js"><link rel="prefetch" href="/assets/js/169.a7b202df.js"><link rel="prefetch" href="/assets/js/17.f5c75867.js"><link rel="prefetch" href="/assets/js/170.335ec3d4.js"><link rel="prefetch" href="/assets/js/171.127a05ea.js"><link rel="prefetch" href="/assets/js/172.38f3469f.js"><link rel="prefetch" href="/assets/js/173.717c6334.js"><link rel="prefetch" href="/assets/js/174.5e397c4c.js"><link rel="prefetch" href="/assets/js/175.3a8b517f.js"><link rel="prefetch" href="/assets/js/176.652cf22d.js"><link rel="prefetch" href="/assets/js/177.9b6aac57.js"><link rel="prefetch" href="/assets/js/178.a4cdaa95.js"><link rel="prefetch" href="/assets/js/179.9e129521.js"><link rel="prefetch" href="/assets/js/18.8b737bb8.js"><link rel="prefetch" href="/assets/js/180.c5a1336e.js"><link rel="prefetch" href="/assets/js/181.c740dac8.js"><link rel="prefetch" href="/assets/js/182.5df0b089.js"><link rel="prefetch" href="/assets/js/183.1fc8e747.js"><link rel="prefetch" href="/assets/js/184.19e5e7d3.js"><link rel="prefetch" href="/assets/js/185.d51d729c.js"><link rel="prefetch" href="/assets/js/186.5ea25212.js"><link rel="prefetch" href="/assets/js/187.cc117b84.js"><link rel="prefetch" href="/assets/js/188.b7bdd1b5.js"><link rel="prefetch" href="/assets/js/189.24e06899.js"><link rel="prefetch" href="/assets/js/19.9527e367.js"><link rel="prefetch" href="/assets/js/190.74bbac0a.js"><link rel="prefetch" href="/assets/js/191.b140bad8.js"><link rel="prefetch" href="/assets/js/192.56482498.js"><link rel="prefetch" href="/assets/js/193.9f14bffa.js"><link rel="prefetch" href="/assets/js/194.68fa85a3.js"><link rel="prefetch" href="/assets/js/195.b6b6c8ac.js"><link rel="prefetch" href="/assets/js/196.f94dd7b6.js"><link rel="prefetch" href="/assets/js/197.4703e80c.js"><link rel="prefetch" href="/assets/js/198.dfa77337.js"><link rel="prefetch" href="/assets/js/199.e03e3c38.js"><link rel="prefetch" href="/assets/js/20.119220af.js"><link rel="prefetch" href="/assets/js/200.2d7dd2e2.js"><link rel="prefetch" href="/assets/js/201.1c16dd27.js"><link rel="prefetch" href="/assets/js/202.ddb30156.js"><link rel="prefetch" href="/assets/js/203.d6f55845.js"><link rel="prefetch" href="/assets/js/204.2f5e70fc.js"><link rel="prefetch" href="/assets/js/205.200086cb.js"><link rel="prefetch" href="/assets/js/206.788a698d.js"><link rel="prefetch" href="/assets/js/207.4d3033e8.js"><link rel="prefetch" href="/assets/js/208.4e6f641a.js"><link rel="prefetch" href="/assets/js/209.80061b70.js"><link rel="prefetch" href="/assets/js/21.119c45e1.js"><link rel="prefetch" href="/assets/js/210.63bb0e46.js"><link rel="prefetch" href="/assets/js/211.08beb2d0.js"><link rel="prefetch" href="/assets/js/212.bfef3b65.js"><link rel="prefetch" href="/assets/js/213.f07f7f65.js"><link rel="prefetch" href="/assets/js/214.42b7e818.js"><link rel="prefetch" href="/assets/js/215.e8a0eae4.js"><link rel="prefetch" href="/assets/js/216.ad2946ff.js"><link rel="prefetch" href="/assets/js/217.c7076359.js"><link rel="prefetch" href="/assets/js/218.0760b8af.js"><link rel="prefetch" href="/assets/js/219.36c68ffd.js"><link rel="prefetch" href="/assets/js/22.565ed291.js"><link rel="prefetch" href="/assets/js/220.6e502131.js"><link rel="prefetch" href="/assets/js/221.f6534ba4.js"><link rel="prefetch" href="/assets/js/222.0e1f31a9.js"><link rel="prefetch" href="/assets/js/223.3a0ec580.js"><link rel="prefetch" href="/assets/js/224.261990fc.js"><link rel="prefetch" href="/assets/js/225.973a9549.js"><link rel="prefetch" href="/assets/js/226.2151f4d6.js"><link rel="prefetch" href="/assets/js/227.fdbc6dd6.js"><link rel="prefetch" href="/assets/js/228.2302b3ce.js"><link rel="prefetch" href="/assets/js/229.8cda7721.js"><link rel="prefetch" href="/assets/js/23.f0d67525.js"><link rel="prefetch" href="/assets/js/230.8f99b154.js"><link rel="prefetch" href="/assets/js/231.e84d3f81.js"><link rel="prefetch" href="/assets/js/232.8da71053.js"><link rel="prefetch" href="/assets/js/233.47d5ada5.js"><link rel="prefetch" href="/assets/js/234.52ddaf81.js"><link rel="prefetch" href="/assets/js/235.eefc4025.js"><link rel="prefetch" href="/assets/js/236.4a32abb7.js"><link rel="prefetch" href="/assets/js/237.2c96d7b5.js"><link rel="prefetch" href="/assets/js/238.c53417cc.js"><link rel="prefetch" href="/assets/js/239.d959752c.js"><link rel="prefetch" href="/assets/js/24.f38ffb68.js"><link rel="prefetch" href="/assets/js/240.8ba1de94.js"><link rel="prefetch" href="/assets/js/241.5260dfed.js"><link rel="prefetch" href="/assets/js/242.022fddbe.js"><link rel="prefetch" href="/assets/js/243.f3aae9e9.js"><link rel="prefetch" href="/assets/js/25.c049158b.js"><link rel="prefetch" href="/assets/js/26.259b0a50.js"><link rel="prefetch" href="/assets/js/27.ba95c81b.js"><link rel="prefetch" href="/assets/js/28.3b7cc014.js"><link rel="prefetch" href="/assets/js/29.11cff7f7.js"><link rel="prefetch" href="/assets/js/3.89546440.js"><link rel="prefetch" href="/assets/js/30.07f98bd7.js"><link rel="prefetch" href="/assets/js/31.9a370c40.js"><link rel="prefetch" href="/assets/js/32.1e4cddd7.js"><link rel="prefetch" href="/assets/js/33.9b9b6ca5.js"><link rel="prefetch" href="/assets/js/34.198d1e3e.js"><link rel="prefetch" href="/assets/js/35.cc4d049c.js"><link rel="prefetch" href="/assets/js/37.0a73ec16.js"><link rel="prefetch" href="/assets/js/38.5fdacc34.js"><link rel="prefetch" href="/assets/js/39.3462ae29.js"><link rel="prefetch" href="/assets/js/40.7507f434.js"><link rel="prefetch" href="/assets/js/41.9f3fd2c1.js"><link rel="prefetch" href="/assets/js/42.9acfb6a0.js"><link rel="prefetch" href="/assets/js/43.028d37de.js"><link rel="prefetch" href="/assets/js/44.dc7af4e0.js"><link rel="prefetch" href="/assets/js/45.f791596f.js"><link rel="prefetch" href="/assets/js/46.5f6367ea.js"><link rel="prefetch" href="/assets/js/47.23e0116d.js"><link rel="prefetch" href="/assets/js/48.9743d91a.js"><link rel="prefetch" href="/assets/js/49.d9bc1351.js"><link rel="prefetch" href="/assets/js/5.d1f19d5b.js"><link rel="prefetch" href="/assets/js/50.0af62eb1.js"><link rel="prefetch" href="/assets/js/51.feb74d94.js"><link rel="prefetch" href="/assets/js/52.6930b461.js"><link rel="prefetch" href="/assets/js/53.dc3296c8.js"><link rel="prefetch" href="/assets/js/54.57659bce.js"><link rel="prefetch" href="/assets/js/55.43547f85.js"><link rel="prefetch" href="/assets/js/56.6c98b362.js"><link rel="prefetch" href="/assets/js/57.8229a049.js"><link rel="prefetch" href="/assets/js/58.81c28de9.js"><link rel="prefetch" href="/assets/js/59.138a89a4.js"><link rel="prefetch" href="/assets/js/6.2dc682a7.js"><link rel="prefetch" href="/assets/js/60.bd25cf52.js"><link rel="prefetch" href="/assets/js/61.8727d787.js"><link rel="prefetch" href="/assets/js/62.8445d943.js"><link rel="prefetch" href="/assets/js/63.c800805e.js"><link rel="prefetch" href="/assets/js/64.214bba6e.js"><link rel="prefetch" href="/assets/js/65.c8632f2e.js"><link rel="prefetch" href="/assets/js/66.c3d7e780.js"><link rel="prefetch" href="/assets/js/67.6890e0d1.js"><link rel="prefetch" href="/assets/js/68.7727eb98.js"><link rel="prefetch" href="/assets/js/69.14a9554b.js"><link rel="prefetch" href="/assets/js/7.2587e59c.js"><link rel="prefetch" href="/assets/js/70.4bf00af5.js"><link rel="prefetch" href="/assets/js/71.b17a78df.js"><link rel="prefetch" href="/assets/js/72.4ed7fbfb.js"><link rel="prefetch" href="/assets/js/73.606dedb9.js"><link rel="prefetch" href="/assets/js/74.db725d11.js"><link rel="prefetch" href="/assets/js/75.d33f6625.js"><link rel="prefetch" href="/assets/js/76.fdf31f69.js"><link rel="prefetch" href="/assets/js/77.ae894bd8.js"><link rel="prefetch" href="/assets/js/78.ff8d8588.js"><link rel="prefetch" href="/assets/js/79.07f6e12a.js"><link rel="prefetch" href="/assets/js/8.f5666732.js"><link rel="prefetch" href="/assets/js/80.f21590f1.js"><link rel="prefetch" href="/assets/js/81.b4e4cc00.js"><link rel="prefetch" href="/assets/js/82.46a30a2a.js"><link rel="prefetch" href="/assets/js/83.79915984.js"><link rel="prefetch" href="/assets/js/84.b9944f4b.js"><link rel="prefetch" href="/assets/js/85.4e27ff28.js"><link rel="prefetch" href="/assets/js/86.5cad870b.js"><link rel="prefetch" href="/assets/js/87.35b115ee.js"><link rel="prefetch" href="/assets/js/88.d0c1ea42.js"><link rel="prefetch" href="/assets/js/89.094f6d6a.js"><link rel="prefetch" href="/assets/js/9.25ae8f9a.js"><link rel="prefetch" href="/assets/js/90.1fdf86a3.js"><link rel="prefetch" href="/assets/js/91.985f557c.js"><link rel="prefetch" href="/assets/js/92.d82bbfb8.js"><link rel="prefetch" href="/assets/js/93.983d7fd0.js"><link rel="prefetch" href="/assets/js/94.046ee311.js"><link rel="prefetch" href="/assets/js/95.b0e28ffe.js"><link rel="prefetch" href="/assets/js/96.8b9f228e.js"><link rel="prefetch" href="/assets/js/97.bab27371.js"><link rel="prefetch" href="/assets/js/98.0d346986.js"><link rel="prefetch" href="/assets/js/99.f4640a01.js">
    <link rel="stylesheet" href="/assets/css/0.styles.e554653d.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">é£è·ƒé«˜å±±ä¸å¤§æ´‹çš„é±¼</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  é¦–é¡µ
</a></div><div class="nav-item"><a href="/guide/" class="nav-link">
  å…ˆå¯¼
</a></div><div class="nav-item"><a href="/computer/" class="nav-link">
  è®¡ç®—æœº
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="ç³»ç»Ÿ" class="dropdown-title"><span class="title">ç³»ç»Ÿ</span> <span class="arrow down"></span></button> <button type="button" aria-label="ç³»ç»Ÿ" class="mobile-dropdown-title"><span class="title">ç³»ç»Ÿ</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/os/linux/" class="nav-link">
  Linux
</a></li><li class="dropdown-item"><!----> <a href="/os/manjaro/" class="nav-link">
  Manjaro
</a></li><li class="dropdown-item"><!----> <a href="/os/ubuntu/" class="nav-link">
  Ubuntu
</a></li><li class="dropdown-item"><!----> <a href="/os/centos/" class="nav-link">
  CentOS
</a></li><li class="dropdown-item"><!----> <a href="/os/kubernetes/" class="nav-link">
  Kubernetes
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="å‰ç«¯" class="dropdown-title"><span class="title">å‰ç«¯</span> <span class="arrow down"></span></button> <button type="button" aria-label="å‰ç«¯" class="mobile-dropdown-title"><span class="title">å‰ç«¯</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/frontend/javascript/" class="nav-link">
  JavaScript
</a></li><li class="dropdown-item"><!----> <a href="/frontend/typescript/" class="nav-link">
  TypeScript
</a></li><li class="dropdown-item"><!----> <a href="/frontend/css/" class="nav-link">
  CSS
</a></li><li class="dropdown-item"><!----> <a href="/frontend/vue/" class="nav-link">
  Vue
</a></li><li class="dropdown-item"><!----> <a href="/frontend/webpack/" class="nav-link">
  Webpack
</a></li><li class="dropdown-item"><!----> <a href="/frontend/flutter/" class="nav-link">
  Flutter
</a></li><li class="dropdown-item"><!----> <a href="/frontend/weapp/" class="nav-link">
  weapp
</a></li><li class="dropdown-item"><!----> <a href="/frontend/d3js/" class="nav-link">
  D3
</a></li><li class="dropdown-item"><!----> <a href="/frontend/jest/" class="nav-link">
  Jest
</a></li><li class="dropdown-item"><!----> <a href="/frontend/utils/" class="nav-link">
  Utils
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="åç«¯" class="dropdown-title"><span class="title">åç«¯</span> <span class="arrow down"></span></button> <button type="button" aria-label="åç«¯" class="mobile-dropdown-title"><span class="title">åç«¯</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/backend/nodejs/" class="nav-link">
  Nodejs
</a></li><li class="dropdown-item"><!----> <a href="/backend/nestjs/" class="nav-link router-link-active">
  Nestjs
</a></li><li class="dropdown-item"><!----> <a href="/backend/golang/" class="nav-link">
  Golang
</a></li><li class="dropdown-item"><!----> <a href="/backend/nginx/" class="nav-link">
  Nginx
</a></li><li class="dropdown-item"><!----> <a href="/backend/traefik/" class="nav-link">
  Traefik
</a></li><li class="dropdown-item"><!----> <a href="/backend/mysql/" class="nav-link">
  MySQL
</a></li><li class="dropdown-item"><!----> <a href="/backend/mongodb/" class="nav-link">
  MongoDB
</a></li><li class="dropdown-item"><!----> <a href="/backend/redis/" class="nav-link">
  Redis
</a></li><li class="dropdown-item"><!----> <a href="/backend/docker/" class="nav-link">
  Docker
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="ç®—æ³•" class="dropdown-title"><span class="title">ç®—æ³•</span> <span class="arrow down"></span></button> <button type="button" aria-label="ç®—æ³•" class="mobile-dropdown-title"><span class="title">ç®—æ³•</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/algorithms/sort/" class="nav-link">
  æ’åº
</a></li><li class="dropdown-item"><!----> <a href="/algorithms/divide-and-conquer/" class="nav-link">
  åˆ†è€Œæ²»ä¹‹
</a></li><li class="dropdown-item"><!----> <a href="/algorithms/dynamic-programming/" class="nav-link">
  åŠ¨æ€è§„åˆ’
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="å¼€å‘å·¥å…·" class="dropdown-title"><span class="title">å¼€å‘å·¥å…·</span> <span class="arrow down"></span></button> <button type="button" aria-label="å¼€å‘å·¥å…·" class="mobile-dropdown-title"><span class="title">å¼€å‘å·¥å…·</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/tools/git/" class="nav-link">
  Git
</a></li><li class="dropdown-item"><!----> <a href="/tools/github/" class="nav-link">
  Github
</a></li><li class="dropdown-item"><!----> <a href="/tools/vscode/" class="nav-link">
  VSCode
</a></li><li class="dropdown-item"><!----> <a href="/tools/chrome/" class="nav-link">
  Chrome Developer tools
</a></li><li class="dropdown-item"><!----> <a href="/tools/bookmark-scripts/" class="nav-link">
  Bookmark scripts
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="æ›´å¤š" class="dropdown-title"><span class="title">æ›´å¤š</span> <span class="arrow down"></span></button> <button type="button" aria-label="æ›´å¤š" class="mobile-dropdown-title"><span class="title">æ›´å¤š</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/æ›´å¤šğŸ‰/navigation.html" class="nav-link">
  å¯¼èˆª ğŸ‰
</a></li><li class="dropdown-item"><!----> <a href="https://vuepress.vuejs.org/zh/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  VuePress å®˜ç½‘
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <a href="https://github.com/shanyuhai123/documents" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  é¦–é¡µ
</a></div><div class="nav-item"><a href="/guide/" class="nav-link">
  å…ˆå¯¼
</a></div><div class="nav-item"><a href="/computer/" class="nav-link">
  è®¡ç®—æœº
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="ç³»ç»Ÿ" class="dropdown-title"><span class="title">ç³»ç»Ÿ</span> <span class="arrow down"></span></button> <button type="button" aria-label="ç³»ç»Ÿ" class="mobile-dropdown-title"><span class="title">ç³»ç»Ÿ</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/os/linux/" class="nav-link">
  Linux
</a></li><li class="dropdown-item"><!----> <a href="/os/manjaro/" class="nav-link">
  Manjaro
</a></li><li class="dropdown-item"><!----> <a href="/os/ubuntu/" class="nav-link">
  Ubuntu
</a></li><li class="dropdown-item"><!----> <a href="/os/centos/" class="nav-link">
  CentOS
</a></li><li class="dropdown-item"><!----> <a href="/os/kubernetes/" class="nav-link">
  Kubernetes
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="å‰ç«¯" class="dropdown-title"><span class="title">å‰ç«¯</span> <span class="arrow down"></span></button> <button type="button" aria-label="å‰ç«¯" class="mobile-dropdown-title"><span class="title">å‰ç«¯</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/frontend/javascript/" class="nav-link">
  JavaScript
</a></li><li class="dropdown-item"><!----> <a href="/frontend/typescript/" class="nav-link">
  TypeScript
</a></li><li class="dropdown-item"><!----> <a href="/frontend/css/" class="nav-link">
  CSS
</a></li><li class="dropdown-item"><!----> <a href="/frontend/vue/" class="nav-link">
  Vue
</a></li><li class="dropdown-item"><!----> <a href="/frontend/webpack/" class="nav-link">
  Webpack
</a></li><li class="dropdown-item"><!----> <a href="/frontend/flutter/" class="nav-link">
  Flutter
</a></li><li class="dropdown-item"><!----> <a href="/frontend/weapp/" class="nav-link">
  weapp
</a></li><li class="dropdown-item"><!----> <a href="/frontend/d3js/" class="nav-link">
  D3
</a></li><li class="dropdown-item"><!----> <a href="/frontend/jest/" class="nav-link">
  Jest
</a></li><li class="dropdown-item"><!----> <a href="/frontend/utils/" class="nav-link">
  Utils
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="åç«¯" class="dropdown-title"><span class="title">åç«¯</span> <span class="arrow down"></span></button> <button type="button" aria-label="åç«¯" class="mobile-dropdown-title"><span class="title">åç«¯</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/backend/nodejs/" class="nav-link">
  Nodejs
</a></li><li class="dropdown-item"><!----> <a href="/backend/nestjs/" class="nav-link router-link-active">
  Nestjs
</a></li><li class="dropdown-item"><!----> <a href="/backend/golang/" class="nav-link">
  Golang
</a></li><li class="dropdown-item"><!----> <a href="/backend/nginx/" class="nav-link">
  Nginx
</a></li><li class="dropdown-item"><!----> <a href="/backend/traefik/" class="nav-link">
  Traefik
</a></li><li class="dropdown-item"><!----> <a href="/backend/mysql/" class="nav-link">
  MySQL
</a></li><li class="dropdown-item"><!----> <a href="/backend/mongodb/" class="nav-link">
  MongoDB
</a></li><li class="dropdown-item"><!----> <a href="/backend/redis/" class="nav-link">
  Redis
</a></li><li class="dropdown-item"><!----> <a href="/backend/docker/" class="nav-link">
  Docker
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="ç®—æ³•" class="dropdown-title"><span class="title">ç®—æ³•</span> <span class="arrow down"></span></button> <button type="button" aria-label="ç®—æ³•" class="mobile-dropdown-title"><span class="title">ç®—æ³•</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/algorithms/sort/" class="nav-link">
  æ’åº
</a></li><li class="dropdown-item"><!----> <a href="/algorithms/divide-and-conquer/" class="nav-link">
  åˆ†è€Œæ²»ä¹‹
</a></li><li class="dropdown-item"><!----> <a href="/algorithms/dynamic-programming/" class="nav-link">
  åŠ¨æ€è§„åˆ’
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="å¼€å‘å·¥å…·" class="dropdown-title"><span class="title">å¼€å‘å·¥å…·</span> <span class="arrow down"></span></button> <button type="button" aria-label="å¼€å‘å·¥å…·" class="mobile-dropdown-title"><span class="title">å¼€å‘å·¥å…·</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/tools/git/" class="nav-link">
  Git
</a></li><li class="dropdown-item"><!----> <a href="/tools/github/" class="nav-link">
  Github
</a></li><li class="dropdown-item"><!----> <a href="/tools/vscode/" class="nav-link">
  VSCode
</a></li><li class="dropdown-item"><!----> <a href="/tools/chrome/" class="nav-link">
  Chrome Developer tools
</a></li><li class="dropdown-item"><!----> <a href="/tools/bookmark-scripts/" class="nav-link">
  Bookmark scripts
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="æ›´å¤š" class="dropdown-title"><span class="title">æ›´å¤š</span> <span class="arrow down"></span></button> <button type="button" aria-label="æ›´å¤š" class="mobile-dropdown-title"><span class="title">æ›´å¤š</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/æ›´å¤šğŸ‰/navigation.html" class="nav-link">
  å¯¼èˆª ğŸ‰
</a></li><li class="dropdown-item"><!----> <a href="https://vuepress.vuejs.org/zh/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  VuePress å®˜ç½‘
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <a href="https://github.com/shanyuhai123/documents" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>NESTJS</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/backend/nestjs/" aria-current="page" class="sidebar-link">é¦–é¡µ</a></li><li><a href="/backend/nestjs/architecture.html" class="sidebar-link">æ¶æ„</a></li><li><a href="/backend/nestjs/typeorm.html" aria-current="page" class="active sidebar-link">TypeORM</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/backend/nestjs/typeorm.html#ä»‹ç»" class="sidebar-link">ä»‹ç»</a></li><li class="sidebar-sub-header"><a href="/backend/nestjs/typeorm.html#åˆ†æ­¥æŒ‡å—" class="sidebar-link">åˆ†æ­¥æŒ‡å—</a></li><li class="sidebar-sub-header"><a href="/backend/nestjs/typeorm.html#å®ä½“" class="sidebar-link">å®ä½“</a></li><li class="sidebar-sub-header"><a href="/backend/nestjs/typeorm.html#å…³ç³»" class="sidebar-link">å…³ç³»</a></li></ul></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h2 id="ä»‹ç»"><a href="#ä»‹ç»" class="header-anchor">#</a> ä»‹ç»</h2> <p><a href="https://typeorm.io/" target="_blank" rel="noopener noreferrer">TypeORM<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> æ˜¯ä¸€ä¸ª <a href="https://en.wikipedia.org/wiki/Object-relational_mapping" target="_blank" rel="noopener noreferrer">ORM<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> æ¡†æ¶ã€‚</p> <p>å¯ç®€å•ç†è§£ä¸ºï¼š</p> <div class="language- extra-class"><pre class="language-text"><code>æ•°æ®åº“çš„è¡¨ï¼ˆtableï¼‰ --&gt; ç±»ï¼ˆclassï¼‰
è®°å½•ï¼ˆrecordï¼Œè¡Œæ•°æ®ï¼‰--&gt; å¯¹è±¡å®ä¾‹ï¼ˆobjectï¼‰
å­—æ®µï¼ˆfieldï¼‰--&gt; å¯¹è±¡çš„å±æ€§ï¼ˆattributeï¼‰
</code></pre></div><p>ä»¥ä¸‹æœ‰ä¸€äº›ç‰¹æ€§ï¼ˆå¥½å¤„ï¼‰çš„è¯´æ˜ï¼Œä½†ç³Ÿç³•çš„æ˜¯å­¦ä¹  ORM çš„æˆæœ¬å¹¶ä¸ä½ï¼Œäºæ˜¯æœ‰äº†è¿™ç¯‡æŠ„å†™ï¼ˆç›¸å¯¹åŸæ–‡ç­›å‡ï¼‰ã€‚</p> <h2 id="åˆ†æ­¥æŒ‡å—"><a href="#åˆ†æ­¥æŒ‡å—" class="header-anchor">#</a> åˆ†æ­¥æŒ‡å—</h2> <h3 id="_1-åˆ›å»ºä¸€ä¸ªæ¨¡å‹"><a href="#_1-åˆ›å»ºä¸€ä¸ªæ¨¡å‹" class="header-anchor">#</a> 1. åˆ›å»ºä¸€ä¸ªæ¨¡å‹</h3> <p>ä½¿ç”¨æ•°æ®åº“ä»åˆ›å»ºè¡¨å¼€å§‹ã€‚å¦‚ä½•å‘Šè¯‰ TypeORM åˆ›å»ºæ•°æ®åº“è¡¨ï¼Ÿç­”æ¡ˆæ˜¯ - é€šè¿‡æ¨¡å‹ã€‚åº”ç”¨ç¨‹åºä¸­çš„æ¨¡å‹å³æ•°æ®åº“çš„è¡¨ã€‚</p> <p>ä¸¾ä¸ªä¾‹å­ï¼Œå­˜åœ¨ <code>Photo</code> æ¨¡å‹ï¼š</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">Photo</span> <span class="token punctuation">{</span>
  id<span class="token operator">:</span> <span class="token builtin">number</span>
  name<span class="token operator">:</span> <span class="token builtin">string</span>
  description<span class="token operator">:</span> <span class="token builtin">string</span>
  filename<span class="token operator">:</span> <span class="token builtin">string</span>
  views<span class="token operator">:</span> <span class="token builtin">number</span>
<span class="token punctuation">}</span>
</code></pre></div><p>å¹¶ä¸”å¸Œæœ›å°† photos å­˜å‚¨åœ¨æ•°æ®åº“ä¸­ã€‚è¦åœ¨æ•°æ®åº“ä¸­å­˜å‚¨å†…å®¹ï¼Œé¦–å…ˆéœ€è¦ä¸€ä¸ªæ•°æ®åº“è¡¨ï¼Œå¹¶ä»æ¨¡å‹ä¸­åˆ›å»ºæ•°æ®åº“è¡¨ã€‚ä½†æ˜¯å¹¶éæ‰€æœ‰æ¨¡å‹ï¼Œåªæœ‰å®šä¹‰ä¸º entities çš„æ¨¡å‹æ‰ä¼šè¢«ä½¿ç”¨ã€‚</p> <h3 id="_2-åˆ›å»ºä¸€ä¸ªå®ä½“"><a href="#_2-åˆ›å»ºä¸€ä¸ªå®ä½“" class="header-anchor">#</a> 2. åˆ›å»ºä¸€ä¸ªå®ä½“</h3> <p>å®ä½“æ˜¯ç”± <code>@Entity</code> è£…é¥°å™¨è£…é¥°çš„æ¨¡å‹ã€‚å°†ä¸ºæ­¤æ¨¡å‹åˆ›å»ºæ•°æ®åº“è¡¨ã€‚</p> <p>å°† <code>Photo</code> æ¨¡å‹è½¬ä¸ºä¸€ä¸ªå®ä½“ï¼Œæ­¤å¤„é‡‡ç”¨ Active Record æ¨¡å¼ï¼š</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Entity<span class="token punctuation">,</span> BaseEntity <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'typeorm'</span>

@<span class="token function">Entity</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">Photo</span> <span class="token keyword">extends</span> <span class="token class-name">BaseEntity</span> <span class="token punctuation">{</span>
  id<span class="token operator">:</span> <span class="token builtin">number</span>
  name<span class="token operator">:</span> <span class="token builtin">string</span>
  description<span class="token operator">:</span> <span class="token builtin">string</span>
  filename<span class="token operator">:</span> <span class="token builtin">string</span>
  views<span class="token operator">:</span> <span class="token builtin">number</span>
<span class="token punctuation">}</span>
</code></pre></div><p>ç°åœ¨ï¼Œå°†ä¸º <code>Photo</code> å®ä½“åˆ›å»ºä¸€ä¸ªæ•°æ®åº“è¡¨ï¼Œä½†æ²¡æœ‰æŒ‡æ˜å“ªä¸ªå­—æ®µå±äºå“ªä¸€åˆ—ã€‚</p> <h3 id="_3-æ·»åŠ è¡¨åˆ—"><a href="#_3-æ·»åŠ è¡¨åˆ—" class="header-anchor">#</a> 3. æ·»åŠ è¡¨åˆ—</h3> <p>è¦æ·»åŠ æ•°æ®åˆ—ï¼Œåªéœ€è¦å°†è¦ç”Ÿæˆçš„å®ä½“å±æ€§åŠ ä¸Š <code>@Column</code> è£…é¥°å™¨ï¼š</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Entity<span class="token punctuation">,</span> BaseEntity<span class="token punctuation">,</span> Column <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'typeorm'</span>

@<span class="token function">Entity</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">Photo</span> <span class="token keyword">extends</span> <span class="token class-name">BaseEntity</span> <span class="token punctuation">{</span>
	@<span class="token function">Column</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  id<span class="token operator">:</span> <span class="token builtin">number</span>
  
  @<span class="token function">Column</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  name<span class="token operator">:</span> <span class="token builtin">string</span>
  
  @<span class="token function">Column</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  description<span class="token operator">:</span> <span class="token builtin">string</span>
  
  @<span class="token function">Column</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  filename<span class="token operator">:</span> <span class="token builtin">string</span>
  
  @<span class="token function">Column</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  views<span class="token operator">:</span> <span class="token builtin">number</span>
  
  @<span class="token function">Column</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  isPublished<span class="token operator">:</span> <span class="token builtin">boolean</span>
<span class="token punctuation">}</span>
</code></pre></div><p>ç°åœ¨ï¼Œ<code>id</code>ã€<code>name</code>ã€<code>description</code>ã€<code>filename</code>ã€<code>views</code> å’Œ <code>isPublished</code> åˆ—å°†ä¼šè¢«æ·»åŠ åˆ° <code>Photo</code> è¡¨ä¸­ã€‚æ•°æ®åº“ä¸­çš„åˆ—ç±»å‹ä¼šæ ¹æ®å±æ€§ç±»å‹æ¨æ–­ï¼Œä¾‹å¦‚ï¼š<code>number</code> å°†ä¼šè¢«è½¬ä¸º <code>integer</code>ï¼Œ<code>string</code> å°†è¢«è½¬ä¸º <code>varchar</code>ï¼Œ<code>boolean</code> å°†è¢«è½¬ä¸º <code>bool</code> ç­‰ï¼Œå½“ç„¶ä¹Ÿå¯ä»¥æ‰‹åŠ¨æŒ‡å®šç±»å‹ã€‚</p> <p>æˆ‘ä»¬å·²ç»ç”Ÿæˆäº†ä¸€ä¸ªåŒ…å«åˆ—çš„æ•°æ®åº“è¡¨ï¼Œä½†æ˜¯åˆ«å¿˜äº†ï¼Œæ¯ä¸ªæ•°æ®åº“è¡¨å¿…é¡»åŒ…å«ä¸»é”®çš„åˆ—ã€‚</p> <h3 id="_4-åˆ›å»ºä¸»åˆ—"><a href="#_4-åˆ›å»ºä¸»åˆ—" class="header-anchor">#</a> 4. åˆ›å»ºä¸»åˆ—</h3> <p>æ¯ä¸ªè¡¨å¿…é¡»è‡³å°‘æœ‰ä¸€ä¸ªä¸»é”®ï¼Œè¿™æ˜¯å¿…é¡»çš„ï¼Œæ— æ³•é¿å…ã€‚è¦ä½¿åˆ—æˆä¸ºä¸»é”®ï¼Œå¯ä½¿ç”¨ <code>@PrimaryColumn</code> è£…é¥°å™¨ï¼š</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Entity<span class="token punctuation">,</span> BaseEntity<span class="token punctuation">,</span> PrimaryColumn<span class="token punctuation">,</span> Column <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'typeorm'</span>

@<span class="token function">Entity</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">Photo</span> <span class="token keyword">extends</span> <span class="token class-name">BaseEntity</span> <span class="token punctuation">{</span>
	@<span class="token function">PrimaryColumn</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  id<span class="token operator">:</span> <span class="token builtin">number</span>
  
  @<span class="token function">Column</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  name<span class="token operator">:</span> <span class="token builtin">string</span>
  
  @<span class="token function">Column</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  description<span class="token operator">:</span> <span class="token builtin">string</span>
  
  @<span class="token function">Column</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  filename<span class="token operator">:</span> <span class="token builtin">string</span>
  
  @<span class="token function">Column</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  views<span class="token operator">:</span> <span class="token builtin">number</span>
  
  @<span class="token function">Column</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  isPublished<span class="token operator">:</span> <span class="token builtin">boolean</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="_5-åˆ›å»ºè‡ªåŠ¨ç”Ÿæˆçš„åˆ—"><a href="#_5-åˆ›å»ºè‡ªåŠ¨ç”Ÿæˆçš„åˆ—" class="header-anchor">#</a> 5. åˆ›å»ºè‡ªåŠ¨ç”Ÿæˆçš„åˆ—</h3> <p>å‡è®¾ä½ å¸Œæœ› <code>id</code> åˆ—è‡ªåŠ¨ç”Ÿæˆï¼Œä¸ºæ­¤ä½ éœ€è¦å°† <code>@PrimaryColumn</code> æ›¿æ¢ä¸º <code>@PrimaryGeneratedColumn</code> è£…é¥°å™¨ï¼š</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Entity<span class="token punctuation">,</span> BaseEntity<span class="token punctuation">,</span> PrimaryGeneratedColumn<span class="token punctuation">,</span> Column <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'typeorm'</span>

@<span class="token function">Entity</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">Photo</span> <span class="token keyword">extends</span> <span class="token class-name">BaseEntity</span> <span class="token punctuation">{</span>
	@<span class="token function">PrimaryGeneratedColumn</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  id<span class="token operator">:</span> <span class="token builtin">number</span>
  
  @<span class="token function">Column</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  name<span class="token operator">:</span> <span class="token builtin">string</span>
  
  @<span class="token function">Column</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  description<span class="token operator">:</span> <span class="token builtin">string</span>
  
  @<span class="token function">Column</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  filename<span class="token operator">:</span> <span class="token builtin">string</span>
  
  @<span class="token function">Column</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  views<span class="token operator">:</span> <span class="token builtin">number</span>
  
  @<span class="token function">Column</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  isPublished<span class="token operator">:</span> <span class="token builtin">boolean</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="_6-åˆ—æ•°æ®ç±»å‹"><a href="#_6-åˆ—æ•°æ®ç±»å‹" class="header-anchor">#</a> 6. åˆ—æ•°æ®ç±»å‹</h3> <p>åœ¨æ·»åŠ è¡¨åˆ—ä¸­ä»‹ç»äº†é»˜è®¤æ˜ å°„ç±»å‹ï¼Œä½†å®é™…ä¸Šå¹¶éæƒ³è¦çš„ç±»å‹ï¼š</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Entity<span class="token punctuation">,</span> BaseEntity<span class="token punctuation">,</span> PrimaryGeneratedColumn<span class="token punctuation">,</span> Column <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'typeorm'</span>

@<span class="token function">Entity</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">Photo</span> <span class="token keyword">extends</span> <span class="token class-name">BaseEntity</span> <span class="token punctuation">{</span>
	@<span class="token function">PrimaryGeneratedColumn</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  id<span class="token operator">:</span> <span class="token builtin">number</span>
  
  @<span class="token function">Column</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    length<span class="token operator">:</span> <span class="token number">100</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  name<span class="token operator">:</span> <span class="token builtin">string</span>
  
  @<span class="token function">Column</span><span class="token punctuation">(</span><span class="token string">&quot;text&quot;</span><span class="token punctuation">)</span>
  description<span class="token operator">:</span> <span class="token builtin">string</span>
  
  @<span class="token function">Column</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  filename<span class="token operator">:</span> <span class="token builtin">string</span>
  
  @<span class="token function">Column</span><span class="token punctuation">(</span><span class="token string">&quot;double&quot;</span><span class="token punctuation">)</span>
  views<span class="token operator">:</span> <span class="token builtin">number</span>
  
  @<span class="token function">Column</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  isPublished<span class="token operator">:</span> <span class="token builtin">boolean</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="_7-æ•°æ®åº“å¢åˆ æ”¹æŸ¥"><a href="#_7-æ•°æ®åº“å¢åˆ æ”¹æŸ¥" class="header-anchor">#</a> 7. æ•°æ®åº“å¢åˆ æ”¹æŸ¥</h3> <p>åœ¨ Active Record æ¨¡å¼ä¸‹ä½¿ç”¨ï¼š</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">const</span> photo <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Photo</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
photo<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">&quot;photo name&quot;</span>
photo<span class="token punctuation">.</span>description <span class="token operator">=</span> <span class="token string">&quot;photo description&quot;</span>
photo<span class="token punctuation">.</span>filename <span class="token operator">=</span> <span class="token string">&quot;photo filename&quot;</span>
photo<span class="token punctuation">.</span>isPublished <span class="token operator">=</span> <span class="token boolean">true</span>

<span class="token comment">// ä¿å­˜/æ›´æ–°</span>
<span class="token keyword">await</span> photo<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">// åˆ é™¤</span>
<span class="token keyword">await</span> photo<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">// æŸ¥è¯¢</span>
<span class="token keyword">await</span> Photo<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">{</span> skip<span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span> take<span class="token operator">:</span> <span class="token number">5</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">await</span> Photo<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">{</span> isPublished<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">await</span> Photo<span class="token punctuation">.</span><span class="token function">findOne</span><span class="token punctuation">(</span><span class="token punctuation">{</span> name<span class="token operator">:</span> <span class="token string">&quot;photo name&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>å½“ä½¿ç”¨ <code>save</code> ä¿å­˜å®ä½“æ—¶ï¼Œå®ƒæ€»æ˜¯å…ˆå°è¯•ä½¿ç”¨ç»™å®šçš„å®ä½“ ID åœ¨æ•°æ®åº“ä¸­æŸ¥æ‰¾å®ä½“ï¼Œå¦‚æœæ‰¾åˆ°åˆ™æ›´æ–°æ•°æ®åº“ä¸­çš„è¿™ä¸€è¡Œï¼Œå¦‚æœæ²¡æœ‰åˆ™æ’å…¥ä¸€ä¸ªæ–°è¡Œã€‚</p> <h3 id="_8-åˆ›å»ºä¸€å¯¹ä¸€çš„å…³ç³»"><a href="#_8-åˆ›å»ºä¸€å¯¹ä¸€çš„å…³ç³»" class="header-anchor">#</a> 8. åˆ›å»ºä¸€å¯¹ä¸€çš„å…³ç³»</h3> <p>è¦ä¸å¦ä¸€ä¸ªç±»åˆ›å»ºä¸€å¯¹ä¸€çš„å…³ç³»ï¼Œéœ€è¦åœ¨å½“å‰ç±»åŒ…å«å¦ä¸€ä¸ªç±»çš„ä¿¡æ¯ï¼š</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Entity<span class="token punctuation">,</span> BaseEntity<span class="token punctuation">,</span> PrimaryGeneratedColumn<span class="token punctuation">,</span> Column<span class="token punctuation">,</span> OneToOne<span class="token punctuation">,</span> JoinColumn <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'typeorm'</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Photo <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./Photo'</span>

@<span class="token function">Entity</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">PhotoMetadata</span> <span class="token keyword">extends</span> <span class="token class-name">BaseEntity</span> <span class="token punctuation">{</span>
  @<span class="token function">PrimaryGeneratedColumn</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  id<span class="token operator">:</span> <span class="token builtin">number</span>
  
  @<span class="token function">Column</span><span class="token punctuation">(</span><span class="token string">'int'</span><span class="token punctuation">)</span>
  height<span class="token operator">:</span> <span class="token builtin">number</span>
  
  @<span class="token function">Column</span><span class="token punctuation">(</span><span class="token string">'int'</span><span class="token punctuation">)</span>
  width<span class="token operator">:</span> <span class="token builtin">number</span>
  
  @<span class="token function">Column</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  orientation<span class="token operator">:</span> <span class="token builtin">string</span>
  
  @<span class="token function">Column</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  compressed<span class="token operator">:</span> <span class="token builtin">boolean</span>
  
  @<span class="token function">Column</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  comment<span class="token operator">:</span> <span class="token builtin">string</span>
  
  @<span class="token function">OneToOne</span><span class="token punctuation">(</span><span class="token keyword">type</span> <span class="token operator">=&gt;</span> Photo<span class="token punctuation">)</span>
  @<span class="token function">JoinColumn</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  photo<span class="token operator">:</span> Photo
<span class="token punctuation">}</span>
</code></pre></div><p>è¿™é‡Œä½¿ç”¨äº†ä¸€ä¸ªåä¸º <code>@OneToOne</code> çš„è£…é¥°å™¨ï¼Œå®ƒå…è®¸åœ¨ä¸¤ä¸ªå®ä½“ä¹‹é—´åˆ›å»ºä¸€å¯¹ä¸€çš„å…³ç³»ã€‚<code>type =&gt; Photo</code> æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œè¿”å›æƒ³è¦ä¸ä¹‹å»ºç«‹å…³ç³»çš„å®ä½“çš„ç±»ã€‚ç”±äºç‰¹å®šè¯­è¨€çš„å…³ç³»ï¼Œåªèƒ½ä½¿ç”¨ä¸€ä¸ªè¿”å›ç±»çš„å‡½æ•°ï¼Œè€Œä¸æ˜¯ç›´æ¥ä½¿ç”¨è¯¥ç±»ã€‚åŒæ—¶ä¹Ÿå¯ä»¥æŠŠå®ƒå†™æˆ <code>() =&gt; Photo</code>ï¼Œä½†æ˜¯ <code>type =&gt; Photo</code> æ˜¾å¾—ä»£ç æ›´æœ‰å¯è¯»æ€§ã€‚<code>type</code> å˜é‡æœ¬èº«ä¸åŒ…å«ä»»ä½•å†…å®¹ã€‚</p> <p>è¿˜æœ‰ <code>@JoinColumn</code> è£…é¥°å™¨ï¼Œè¡¨æ˜å®ä½“é”®çš„å¯¹åº”å…³ç³»ã€‚å…³ç³»å¯ä»¥æ—¶å•å‘çš„æˆ–åŒå‘çš„ã€‚ä½†æ˜¯åªæœ‰ä¸€æ–¹å¯ä»¥æ‹¥æœ‰ï¼Œåœ¨å…³ç³»çš„æ‰€æœ‰è€…æ–¹ä¸­éœ€è¦ä½¿ç”¨ <code>@JoinColumn</code> è£…é¥°å™¨ã€‚</p> <h3 id="_9-ä¿å­˜ä¸€å¯¹ä¸€çš„å…³ç³»"><a href="#_9-ä¿å­˜ä¸€å¯¹ä¸€çš„å…³ç³»" class="header-anchor">#</a> 9. ä¿å­˜ä¸€å¯¹ä¸€çš„å…³ç³»</h3> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">const</span> photo <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Photo</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
photo<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">&quot;photo name&quot;</span>
photo<span class="token punctuation">.</span>description <span class="token operator">=</span> <span class="token string">&quot;photo description&quot;</span>
photo<span class="token punctuation">.</span>filename <span class="token operator">=</span> <span class="token string">&quot;photo filename&quot;</span>
photo<span class="token punctuation">.</span>isPublished <span class="token operator">=</span> <span class="token boolean">true</span>

<span class="token keyword">const</span> metadata <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PhotoMetadata</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
metadata<span class="token punctuation">.</span>height <span class="token operator">=</span> <span class="token number">640</span><span class="token punctuation">;</span>
metadata<span class="token punctuation">.</span>width <span class="token operator">=</span> <span class="token number">480</span><span class="token punctuation">;</span>
metadata<span class="token punctuation">.</span>compressed <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
metadata<span class="token punctuation">.</span>comment <span class="token operator">=</span> <span class="token string">&quot;metadata comment&quot;</span><span class="token punctuation">;</span>
metadata<span class="token punctuation">.</span>orientation <span class="token operator">=</span> <span class="token string">&quot;portait&quot;</span><span class="token punctuation">;</span>
metadata<span class="token punctuation">.</span>photo <span class="token operator">=</span> photo<span class="token punctuation">;</span> <span class="token comment">// è”æ¥ä¸¤è€…</span>

<span class="token comment">// å…ˆä¿å­˜ photo</span>
<span class="token keyword">await</span> photo<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">// å†ä¿å­˜ photo çš„ metadata</span>
<span class="token keyword">await</span> metadata<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="_10-åå‘å…³ç³»"><a href="#_10-åå‘å…³ç³»" class="header-anchor">#</a> 10. åå‘å…³ç³»</h3> <p>å…³ç³»å¯ä»¥æ˜¯å•å‘çš„æˆ–åŒå‘çš„ã€‚ç›®å‰ PhotoMetadata å’Œ Photo ä¹‹é—´çš„å…³ç³»æ˜¯å•å‘çš„ã€‚å…³ç³»çš„æ‰€æœ‰è€…æ—¶ PhotoMetadataï¼Œè€Œ Photo å¯¹ PhotoMetadata ä¸€æ— æ‰€çŸ¥ã€‚è¿™ä½¿å¾—ä» Photo ä¸­è®¿é—® PhotoMetadata å˜å¾—å¾ˆå¤æ‚ã€‚è¦è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬åº”è¯¥åœ¨å®ƒä»¬ä¹‹é—´å»ºç«‹åŒå‘å…³ç³»ã€‚</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token comment">// PhotoMetadata.ts</span>
@<span class="token function">Entity</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">PhotoMetadata</span> <span class="token keyword">extends</span> <span class="token class-name">BaseEntity</span> <span class="token punctuation">{</span>
  <span class="token comment">/* çœç•¥å…¶ä»–åˆ— */</span>
  
  @<span class="token function">OneToOne</span><span class="token punctuation">(</span><span class="token keyword">type</span> <span class="token operator">=&gt;</span> Photo<span class="token punctuation">,</span> photo <span class="token operator">=&gt;</span> photo<span class="token punctuation">.</span>metadata<span class="token punctuation">)</span>
  @<span class="token function">JoinColumn</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  photo<span class="token operator">:</span> Photo
<span class="token punctuation">}</span>
</code></pre></div><div class="language-ts extra-class"><pre class="language-ts"><code><span class="token comment">// Photo.ts</span>
@<span class="token function">Entity</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">Photo</span> <span class="token keyword">extends</span> <span class="token class-name">BaseEntity</span> <span class="token punctuation">{</span>
  <span class="token comment">/* çœç•¥å…¶ä»–åˆ— */</span>
  
  @<span class="token function">OneToOne</span><span class="token punctuation">(</span><span class="token keyword">type</span> <span class="token operator">=&gt;</span> PhotoMetadata<span class="token punctuation">,</span> photoMetadata <span class="token operator">=&gt;</span> photoMetadata<span class="token punctuation">.</span>photo<span class="token punctuation">)</span>
  metadata<span class="token operator">:</span> PhotoMetadata
<span class="token punctuation">}</span>
</code></pre></div><p>æ³¨æ„ï¼Œæˆ‘ä»¬åº”è¯¥ä»…åœ¨å…³ç³»çš„ä¸€ä¾§ä½¿ç”¨ <code>@JoinColumn</code> è£…é¥°å™¨ï¼Œå…³ç³»çš„æ‹¥æœ‰æ–¹åŒ…å«æ•°æ®åº“ä¸­å…·æœ‰å¤–é”®çš„åˆ—ã€‚</p> <h3 id="_11-å–å‡ºå…³ç³»å¯¹è±¡çš„æ•°æ®"><a href="#_11-å–å‡ºå…³ç³»å¯¹è±¡çš„æ•°æ®" class="header-anchor">#</a> 11. å–å‡ºå…³ç³»å¯¹è±¡çš„æ•°æ®</h3> <p>åœ¨å®Œæˆ <strong>åå‘å…³ç³»</strong> åæ‰å¯ä»¥ä½¿ç”¨è¯¥æ–¹æ³•ï¼š</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">await</span> Photo<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">{</span> relations<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'metadata'</span><span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">await</span> Photo<span class="token punctuation">.</span><span class="token function">findOne</span><span class="token punctuation">(</span>id<span class="token punctuation">,</span> <span class="token punctuation">{</span> relations<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'metadata'</span><span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>ä½¿ç”¨ find é€‰é¡¹å¾ˆç®€å•ï¼Œä½†æ˜¯å¦‚æœéœ€è¦æ›´å¤æ‚çš„æŸ¥è¯¢ï¼Œåˆ™åº”è¯¥ä½¿ç”¨ <code>QueryBuilder</code>ï¼š</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">await</span> Photo<span class="token punctuation">.</span><span class="token function">createQueryBuilder</span><span class="token punctuation">(</span><span class="token string">'photo'</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">innerJoinAndSelect</span><span class="token punctuation">(</span><span class="token string">'photo.metadata'</span><span class="token punctuation">,</span> <span class="token string">'metadata'</span><span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">getMany</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="_12-ä½¿ç”¨-cascades-è‡ªåŠ¨ä¿å­˜ç›¸å…³å¯¹è±¡"><a href="#_12-ä½¿ç”¨-cascades-è‡ªåŠ¨ä¿å­˜ç›¸å…³å¯¹è±¡" class="header-anchor">#</a> 12. ä½¿ç”¨ cascades è‡ªåŠ¨ä¿å­˜ç›¸å…³å¯¹è±¡</h3> <p>å¯ä»¥åœ¨å…³ç³»ä¸­è®¾ç½® <code>cascades</code> é€‰é¡¹ï¼Œè¿™æ—¶å°±å¯ä»¥ä¿å­˜å…¶ä»–å¯¹è±¡çš„åŒæ—¶ä¿å­˜ç›¸å…³å¯¹è±¡ã€‚ä¸çŸ¥è¿™æ ·æ˜¯å¦ä¼šå½¢æˆäº‹åŠ¡ï¼Ÿ</p> <div class="language-ts extra-class"><pre class="language-ts"><code>@<span class="token function">Entity</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">Photo</span> <span class="token keyword">extends</span> <span class="token class-name">BaseEntity</span> <span class="token punctuation">{</span>
  <span class="token comment">/* çœç•¥å…¶ä»–åˆ— */</span>

  @<span class="token function">OneToOne</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">type</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> PhotoMetadata<span class="token punctuation">,</span> <span class="token punctuation">(</span>photoMetadata<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> photoMetadata<span class="token punctuation">.</span>photo<span class="token punctuation">,</span> <span class="token punctuation">{</span>
    cascade<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  metadata<span class="token operator">:</span> PhotoMetadata<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>åœ¨ä½¿ç”¨æ—¶ï¼š</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">const</span> photo <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Photo</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
photo<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">&quot;photo name&quot;</span>
photo<span class="token punctuation">.</span>description <span class="token operator">=</span> <span class="token string">&quot;photo description&quot;</span>
photo<span class="token punctuation">.</span>filename <span class="token operator">=</span> <span class="token string">&quot;photo filename&quot;</span>
photo<span class="token punctuation">.</span>isPublished <span class="token operator">=</span> <span class="token boolean">true</span>

<span class="token keyword">const</span> metadata <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PhotoMetadata</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
metadata<span class="token punctuation">.</span>height <span class="token operator">=</span> <span class="token number">640</span><span class="token punctuation">;</span>
metadata<span class="token punctuation">.</span>width <span class="token operator">=</span> <span class="token number">480</span><span class="token punctuation">;</span>
metadata<span class="token punctuation">.</span>compressed <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
metadata<span class="token punctuation">.</span>comment <span class="token operator">=</span> <span class="token string">&quot;metadata comment&quot;</span><span class="token punctuation">;</span>
metadata<span class="token punctuation">.</span>orientation <span class="token operator">=</span> <span class="token string">&quot;portait&quot;</span><span class="token punctuation">;</span>
metadata<span class="token punctuation">.</span>photo <span class="token operator">=</span> photo<span class="token punctuation">;</span>

photo<span class="token punctuation">.</span>metadata <span class="token operator">=</span> metadata<span class="token punctuation">;</span>

<span class="token comment">// å…ˆä¿å­˜ photo</span>
<span class="token keyword">await</span> photo<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="_13-åˆ›å»ºå¤šå¯¹ä¸€-ä¸€å¯¹å¤šå…³ç³»"><a href="#_13-åˆ›å»ºå¤šå¯¹ä¸€-ä¸€å¯¹å¤šå…³ç³»" class="header-anchor">#</a> 13. åˆ›å»ºå¤šå¯¹ä¸€/ä¸€å¯¹å¤šå…³ç³»</h3> <p>å‡è®¾ä¸€ä¸ª photo æœ‰ä¸€ä¸ª authorï¼Œæ¯ä¸ª author éƒ½å¯ä»¥æœ‰å¤šä¸ª photosã€‚åˆ›å»ºä¸€ä¸ª <code>Author</code> å®ä½“ï¼š</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">import</span> <span class="token punctuation">{</span>
  BaseEntity<span class="token punctuation">,</span>
  Column<span class="token punctuation">,</span>
  Entity<span class="token punctuation">,</span>
  OneToMany<span class="token punctuation">,</span>
  PrimaryGeneratedColumn<span class="token punctuation">,</span>
<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'typeorm'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Photo <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./photo.entity'</span><span class="token punctuation">;</span>

@<span class="token function">Entity</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">Author</span> <span class="token keyword">extends</span> <span class="token class-name">BaseEntity</span> <span class="token punctuation">{</span>
  @<span class="token function">PrimaryGeneratedColumn</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  id<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>

  @<span class="token function">Column</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>

  @<span class="token function">OneToMany</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> Photo<span class="token punctuation">,</span> <span class="token punctuation">(</span>photo<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> photo<span class="token punctuation">.</span>author<span class="token punctuation">)</span>
  photos<span class="token operator">:</span> Photo<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p><code>Author</code> åŒ…å«åå‘å…³ç³»ã€‚<code>@OneToMany</code> æ€»æ˜¯åå‘çš„ï¼Œå¹¶ä¸”æ€»æ˜¯ä¸ <code>@ManyToOne</code> ä¸€èµ·å‡ºç°ã€‚</p> <div class="language-ts extra-class"><pre class="language-ts"><code>@<span class="token function">Entity</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">Photo</span> <span class="token keyword">extends</span> <span class="token class-name">BaseEntity</span> <span class="token punctuation">{</span>
  <span class="token comment">/* çœç•¥å…¶ä»–åˆ— */</span>

  @<span class="token function">ManyToOne</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> Author<span class="token punctuation">,</span> <span class="token punctuation">(</span>author<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> author<span class="token punctuation">.</span>photos<span class="token punctuation">)</span>
  author<span class="token operator">:</span> Author<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="_14-åˆ›å»ºå¤šå¯¹å¤šå…³ç³»"><a href="#_14-åˆ›å»ºå¤šå¯¹å¤šå…³ç³»" class="header-anchor">#</a> 14. åˆ›å»ºå¤šå¯¹å¤šå…³ç³»</h3> <p>å‡è®¾ä¸€ä¸ª photo å¯ä»¥æ”¾åœ¨å¤šä¸ª album ä¸­ï¼Œæ¯ä¸ª album å¯ä»¥å­˜æ”¾å¤šä¸ª photoã€‚åˆ›å»ºä¸€ä¸ª <code>Album</code> å®ä½“ï¼š</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">import</span> <span class="token punctuation">{</span>
  BaseEntity<span class="token punctuation">,</span>
  Column<span class="token punctuation">,</span>
  Entity<span class="token punctuation">,</span>
  JoinTable<span class="token punctuation">,</span>
  ManyToMany<span class="token punctuation">,</span>
  PrimaryGeneratedColumn<span class="token punctuation">,</span>
<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'typeorm'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Photo <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./photo.entity'</span><span class="token punctuation">;</span>

@<span class="token function">Entity</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">Album</span> <span class="token keyword">extends</span> <span class="token class-name">BaseEntity</span> <span class="token punctuation">{</span>
  @<span class="token function">PrimaryGeneratedColumn</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  id<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>

  @<span class="token function">Column</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>

  @<span class="token function">ManyToMany</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> Photo<span class="token punctuation">,</span> <span class="token punctuation">(</span>photo<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> photo<span class="token punctuation">.</span>album<span class="token punctuation">)</span>
  @<span class="token function">JoinTable</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  photos<span class="token operator">:</span> Photo<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p><code>@JoinTable</code> éœ€è¦æŒ‡å®šè¿™æ˜¯å…³ç³»çš„æ‰€æœ‰è€…æ–¹ã€‚</p> <p>æ¥ç€æ·»åŠ åå‘å…³ç³»åˆ° <code>Photo</code> ä¸­ï¼š</p> <div class="language-ts extra-class"><pre class="language-ts"><code>@<span class="token function">Entity</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">Photo</span> <span class="token keyword">extends</span> <span class="token class-name">BaseEntity</span> <span class="token punctuation">{</span>
  <span class="token comment">/* çœç•¥å…¶ä»–åˆ— */</span>

  @<span class="token function">ManyToMany</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> Album<span class="token punctuation">,</span> <span class="token punctuation">(</span>album<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> album<span class="token punctuation">.</span>photos<span class="token punctuation">)</span>
  album<span class="token operator">:</span> Album<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>æ¥ç€ï¼Œæ•°æ®åº“ä¸­ä¼šå‡ºç° <code>album_photos_photo</code> è”ç»“è¡¨ã€‚</p> <p>ä¿å­˜æ•°æ®ï¼š</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">const</span> album1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Album</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
album1<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">'Bears'</span><span class="token punctuation">;</span>
<span class="token keyword">await</span> album1<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> album2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Album</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
album2<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">'Me'</span><span class="token punctuation">;</span>
<span class="token keyword">await</span> album2<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> photo <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Photo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
photo<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">'photo name3'</span><span class="token punctuation">;</span>
photo<span class="token punctuation">.</span>description <span class="token operator">=</span> <span class="token string">'photo description3'</span><span class="token punctuation">;</span>
photo<span class="token punctuation">.</span>filename <span class="token operator">=</span> <span class="token string">'photo filename3'</span><span class="token punctuation">;</span>
photo<span class="token punctuation">.</span>views <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
photo<span class="token punctuation">.</span>isPublished <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
photo<span class="token punctuation">.</span>album <span class="token operator">=</span> <span class="token punctuation">[</span>album1<span class="token punctuation">,</span> album2<span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">await</span> photo<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>æŸ¥è¯¢ï¼š</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">await</span> Photo<span class="token punctuation">.</span><span class="token function">findOne</span><span class="token punctuation">(</span>id<span class="token punctuation">,</span> <span class="token punctuation">{</span> relations<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'album'</span><span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><h2 id="å®ä½“"><a href="#å®ä½“" class="header-anchor">#</a> å®ä½“</h2> <p>åŸºæœ¬å®ä½“ç”±åˆ—å’Œå…³ç³»ç»„æˆã€‚æ¯ä¸ªå®ä½“å¿…é¡»æœ‰ä¸€ä¸ªä¸»åˆ—ï¼Œå¦åˆ™è¯¥å®ä½“ä¸ä¼šåœ¨æ•°æ®åº“ä¸­ç”Ÿæˆå¯¹åº”çš„è¡¨ã€‚</p> <h3 id="å®ä½“åˆ—ç±»å‹"><a href="#å®ä½“åˆ—ç±»å‹" class="header-anchor">#</a> å®ä½“åˆ—ç±»å‹</h3> <p>å¯ä»¥å°†åˆ—ç±»å‹æŒ‡å®šä¸º <code>@Column</code> çš„ç¬¬ä¸€ä¸ªå‚æ•°ï¼Œæˆ–è€…åœ¨ <code>@Column</code> çš„åˆ—é€‰é¡¹ä¸­æŒ‡å®šï¼š</p> <div class="language-ts extra-class"><pre class="language-ts"><code>@<span class="token function">Column</span><span class="token punctuation">(</span><span class="token string">'int'</span><span class="token punctuation">)</span>
<span class="token comment">// or</span>
@<span class="token function">Column</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token keyword">type</span><span class="token operator">:</span> <span class="token string">'int'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// å¦‚æœè¿˜æœ‰å…¶ä»–å‚æ•°</span>
@<span class="token function">Column</span><span class="token punctuation">(</span><span class="token string">'varchar'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> length<span class="token operator">:</span> <span class="token number">200</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token comment">// or</span>
@<span class="token function">Column</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token keyword">type</span><span class="token operator">:</span> <span class="token string">'varchar'</span><span class="token punctuation">,</span> length<span class="token operator">:</span> <span class="token number">200</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><p>è¿˜æœ‰ä¸€äº›å¸¸ç”¨çš„ç±»å‹ï¼š</p> <ul><li><p><code>enum</code> ç±»å‹ï¼š</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">export</span> <span class="token keyword">enum</span> UserRole <span class="token punctuation">{</span>
  <span class="token constant">ADMIN</span> <span class="token operator">=</span> <span class="token string">'admin'</span><span class="token punctuation">,</span>
  <span class="token constant">EDITOR</span> <span class="token operator">=</span> <span class="token string">'editor'</span><span class="token punctuation">,</span>
  <span class="token constant">GHOST</span> <span class="token operator">=</span> <span class="token string">'ghost'</span>
<span class="token punctuation">}</span>

@<span class="token function">Entity</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">User</span> <span class="token keyword">extends</span> <span class="token class-name">BaseEntity</span> <span class="token punctuation">{</span>
  @<span class="token function">PrimaryGeneratedColumn</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  id<span class="token operator">:</span> <span class="token builtin">number</span>
  
  @<span class="token function">Column</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token keyword">type</span><span class="token operator">:</span> <span class="token string">'enum'</span><span class="token punctuation">,</span>
    <span class="token keyword">enum</span><span class="token operator">:</span> UserRole<span class="token punctuation">,</span>
    <span class="token keyword">default</span><span class="token operator">:</span> UserRole<span class="token punctuation">.</span><span class="token constant">GHOST</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  role<span class="token operator">:</span> Role
<span class="token punctuation">}</span>
</code></pre></div><div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">export</span> <span class="token keyword">enum</span> UserRoleType <span class="token operator">=</span> <span class="token string">'admin'</span> <span class="token operator">|</span> <span class="token string">'editor'</span> <span class="token operator">|</span> <span class="token string">'ghost'</span>

@<span class="token function">Entity</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">User</span> <span class="token keyword">extends</span> <span class="token class-name">BaseEntity</span> <span class="token punctuation">{</span>
  @<span class="token function">PrimaryGeneratedColumn</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  id<span class="token operator">:</span> <span class="token builtin">number</span>
  
  @<span class="token function">Column</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token keyword">type</span><span class="token operator">:</span> <span class="token string">'enum'</span><span class="token punctuation">,</span>
    <span class="token keyword">enum</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'admin'</span><span class="token punctuation">,</span> <span class="token string">'editor'</span><span class="token punctuation">,</span> <span class="token string">'ghost'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token keyword">default</span><span class="token operator">:</span> <span class="token string">'ghost'</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  role<span class="token operator">:</span> Role
<span class="token punctuation">}</span>
</code></pre></div></li> <li><p><code>simple-array</code> ç±»å‹ï¼š</p> <p>æ³¨æ„ä¸èƒ½åœ¨å€¼é‡Œé¢æœ‰ä»»ä½•é€—å·ã€‚</p> <div class="language-ts extra-class"><pre class="language-ts"><code>@<span class="token function">Entity</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">User</span> <span class="token keyword">extends</span> <span class="token class-name">BaseEntity</span> <span class="token punctuation">{</span>
  @<span class="token function">PrimaryGeneratedColumn</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  id<span class="token operator">:</span> <span class="token builtin">number</span>
  
  @<span class="token function">Column</span><span class="token punctuation">(</span><span class="token string">'simple-array'</span><span class="token punctuation">)</span>
  hobbies<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">const</span> user <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">User</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
user<span class="token punctuation">.</span>hobbies <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'play'</span><span class="token punctuation">,</span> <span class="token string">'sleep'</span><span class="token punctuation">]</span>
</code></pre></div></li> <li><p><code>simple-json</code> ç±»å‹ï¼š</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">interface</span> <span class="token class-name">UserProfile</span> <span class="token punctuation">{</span>
  name<span class="token operator">:</span> <span class="token builtin">string</span>
  nickname<span class="token operator">:</span> <span class="token builtin">string</span>
<span class="token punctuation">}</span>

@<span class="token function">Entity</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">User</span> <span class="token keyword">extends</span> <span class="token class-name">BaseEntity</span> <span class="token punctuation">{</span>
  @<span class="token function">PrimaryGeneratedColumn</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  id<span class="token operator">:</span> <span class="token builtin">number</span>
  
  @<span class="token function">Column</span><span class="token punctuation">(</span><span class="token string">'simple-json'</span><span class="token punctuation">)</span>
  profile<span class="token operator">:</span> UserProfile
<span class="token punctuation">}</span>
</code></pre></div><div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">const</span> user <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">User</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
user<span class="token punctuation">.</span>profile <span class="token operator">=</span> <span class="token punctuation">{</span> name<span class="token operator">:</span> <span class="token string">'John'</span><span class="token punctuation">,</span> nickname<span class="token operator">:</span> <span class="token string">'Malkovich'</span> <span class="token punctuation">}</span>
</code></pre></div></li></ul> <h3 id="å®ä½“åˆ—é€‰é¡¹"><a href="#å®ä½“åˆ—é€‰é¡¹" class="header-anchor">#</a> å®ä½“åˆ—é€‰é¡¹</h3> <p>è¯¥é€‰é¡¹å‚è€ƒ <code>ColumnOptions</code> æ¥å£ï¼š</p> <ul><li><code>type: ColumnType</code>ï¼šåˆ—ç±»å‹</li> <li><code>name: string</code>ï¼šæ•°æ®åº“è¡¨ä¸­çš„åˆ—å</li> <li><code>length: number</code>ï¼šåˆ—ç±»å‹çš„é•¿åº¦ï¼Œä¾‹å¦‚åˆ›å»º <code>varchar(150)</code></li> <li><code>width:number</code>ï¼šåˆ—ç±»å‹çš„æ˜¾ç¤ºèŒƒå›´</li> <li><code>onUpdate: string</code>ï¼š<code>ON UPDATE</code> è§¦å‘å™¨</li> <li><code>nullable: boolean</code>ï¼šåœ¨æ•°æ®åº“ä¸­ä½¿åˆ— <code>NULL</code> æˆ– <code>NOT NULL</code>ï¼Œé»˜è®¤ false</li> <li><code>select: boolean</code>ï¼šå®šä¹‰åœ¨æŸ¥è¯¢æ—¶æ˜¯å¦é»˜è®¤æ­¤åˆ—</li> <li><code>default: string</code>ï¼šæ·»åŠ æ•°æ®åº“åˆ—çš„ <code>DEFAULT</code> å€¼</li> <li><code>primary: boolean</code>ï¼šå°†åˆ—æ ‡è®°ä¸ºä¸»è¦åˆ—</li> <li><code>unique: boolean</code>ï¼šå°†åˆ—æ ‡è®°ä¸ºå”¯ä¸€åˆ—</li> <li><code>comment: string</code>ï¼šæ•°æ®åº“åˆ—å¤‡æ³¨</li> <li><code>precision: number</code>ï¼šåè¿›åˆ¶åˆ—çš„ç²¾åº¦ï¼Œè¿™æ˜¯ä¸ºå€¼å­˜å‚¨çš„æœ€å¤§ä½æ•°</li> <li><code>scale: number</code>ï¼šåè¿›åˆ¶åˆ—çš„æ¯”ä¾‹ï¼Œè¡¨ç¤ºå°æ•°ç‚¹å³ä¾§çš„ä½æ•°</li> <li><code>zerofill: boolean</code>ï¼šå°† <code>ZEROFILL</code> å±æ€§è®¾ç½®ä¸ºæ•°å­—åˆ—</li> <li><code>unsigned: boolean</code>ï¼šå°† <code>UNSIGNED</code> å±æ€§è®¾ç½®ä¸ºæ•°å­—åˆ—</li> <li><code>charset: string</code>ï¼šå®šä¹‰åˆ—å­—ç¬¦é›†</li> <li><code>collation: string</code>ï¼šå®šä¹‰åˆ—æ’åºè§„åˆ™</li> <li><code>enum: string[] | AnyEnum</code>ï¼šåœ¨ <code>enum</code> åˆ—ç±»å‹ä¸­ä½¿ç”¨ï¼Œä»¥æŒ‡å®šå…è®¸çš„æšä¸¾å€¼åˆ—è¡¨</li> <li><code>asExpression: string</code>ï¼šç”Ÿæˆçš„åˆ—è¡¨è¾¾å¼</li> <li><code>generatedType: 'VIRTUAL' | 'STORED'</code>ï¼šç”Ÿæˆçš„åˆ—ç±»å‹</li></ul> <h3 id="åµŒå…¥å¼å®ä½“"><a href="#åµŒå…¥å¼å®ä½“" class="header-anchor">#</a> åµŒå…¥å¼å®ä½“</h3> <p>ç›¸å¯¹äºç»§æ‰¿è€Œè¨€ï¼Œç»„åˆå¯èƒ½æ˜¯æ›´å¥½çš„é€‰æ‹©ï¼Œä¸è¿‡è¿™ä¼šå½±å“æ•°æ®åº“çš„åˆ—åã€‚</p> <p>ç»„åˆä¼šå‡å°‘ä»£ç ï¼Œä½†å¹¶ä¸ä¼šå½±å“æ•°æ®åº“ï¼Œå› ä¸ºæœªæä¾›ç”Ÿæˆæ•°æ®åº“è¡¨æ‰€å¿…éœ€çš„ <code>@Entity</code> è£…é¥°å™¨å’Œ <strong>ä¸»é”®</strong>ã€‚</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">Name</span> <span class="token punctuation">{</span>
  @<span class="token function">Column</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  first<span class="token operator">:</span> <span class="token builtin">string</span>
  
  @<span class="token function">Column</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  last<span class="token operator">:</span> <span class="token builtin">string</span>
<span class="token punctuation">}</span>

@<span class="token function">Entity</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">User</span> <span class="token keyword">extends</span> <span class="token class-name">BaseEntity</span> <span class="token punctuation">{</span>
  @<span class="token function">PrimaryGeneratedColumn</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  id<span class="token operator">:</span> <span class="token builtin">string</span>
  
  @<span class="token function">Column</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> Name<span class="token punctuation">)</span>
  name<span class="token operator">:</span> Name
  
  @<span class="token function">Column</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  isActive<span class="token operator">:</span> <span class="token builtin">boolean</span>
<span class="token punctuation">}</span>

@<span class="token function">Entity</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">Employee</span> <span class="token keyword">extends</span> <span class="token class-name">BaseEnity</span> <span class="token punctuation">{</span>
  @<span class="token function">PrimaryGeneratedColumn</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  id<span class="token operator">:</span> <span class="token builtin">string</span>
  
  @<span class="token function">Column</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> Name<span class="token punctuation">)</span>
  name<span class="token operator">:</span> Name
  
  @<span class="token function">Column</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  isActive<span class="token operator">:</span> <span class="token builtin">number</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="æ ‘å®ä½“"><a href="#æ ‘å®ä½“" class="header-anchor">#</a> æ ‘å®ä½“</h3> <p>æ ‘ç»“æ„æ”¯æŒå¤šç§ç±»å‹ï¼Œé™¤ é‚»æ¥åˆ—è¡¨å¤–éƒ½å¯é€šè¿‡ <code>@Tree</code> è£…é¥°å™¨ç®€å•åŒºåˆ†ï¼š</p> <ul><li><code>nested-set</code>ï¼šåµŒå¥—é›†ã€‚å¯¹è¯»å–éå¸¸æœ‰æ•ˆï¼Œä½†å¯¹å†™å…¥ä¸åˆ©ï¼Œä¸”ä¸èƒ½åœ¨åµŒå¥—é›†ä¸­æœ‰å¤šä¸ªæ ¹</li> <li><code>materialized-path</code>ï¼šç‰©åŒ–è·¯å¾„ï¼ˆâ€œè·¯å¾„æšä¸¾â€ï¼‰ã€‚ç®€å•æœ‰æ•ˆ</li> <li><code>closure-table</code>ï¼šé—­åˆè¡¨ã€‚åœ¨è¯»å–å’Œå†™å…¥æ–¹é¢éƒ½å¾ˆæœ‰æ•ˆ</li></ul> <p>ä½¿ç”¨ï¼š</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token comment">// entity</span>
@<span class="token function">Entity</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
@<span class="token function">Tree</span><span class="token punctuation">(</span><span class="token string">'closure-table'</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">Category</span> <span class="token keyword">extends</span> <span class="token class-name">BaseEntity</span> <span class="token punctuation">{</span>
  @<span class="token function">PrimaryGeneratedColumn</span><span class="token punctuation">(</span><span class="token string">'uuid'</span><span class="token punctuation">)</span>
  id<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>

  @<span class="token function">Column</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>

  @<span class="token function">TreeChildren</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  children<span class="token operator">:</span> Category<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

  @<span class="token function">TreeParent</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  parent<span class="token operator">:</span> Category<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>å­˜å‚¨æ•°æ®ï¼š</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">const</span> a1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Category</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
a1<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">'a1'</span><span class="token punctuation">;</span>
<span class="token keyword">await</span> a1<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> a11 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Category</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
a11<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">'a11'</span><span class="token punctuation">;</span>
a11<span class="token punctuation">.</span>parent <span class="token operator">=</span> a1<span class="token punctuation">;</span>
<span class="token keyword">await</span> a11<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> a12 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Category</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
a12<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">'a12'</span><span class="token punctuation">;</span>
a12<span class="token punctuation">.</span>parent <span class="token operator">=</span> a1<span class="token punctuation">;</span>
<span class="token keyword">await</span> a12<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> a111 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Category</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
a111<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">'a111'</span><span class="token punctuation">;</span>
a111<span class="token punctuation">.</span>parent <span class="token operator">=</span> a11<span class="token punctuation">;</span>
<span class="token keyword">await</span> a111<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> a112 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Category</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
a112<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">'a112'</span><span class="token punctuation">;</span>
a112<span class="token punctuation">.</span>parent <span class="token operator">=</span> a11<span class="token punctuation">;</span>
<span class="token keyword">await</span> a112<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>æŸ¥è¯¢æ•°æ®ï¼š</p> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token comment">// è¿”å›æ‰€æœ‰</span>
<span class="token keyword">const</span> trees <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">getTreeRepository</span><span class="token punctuation">(</span>Category<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">findTrees</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">// è¿”å›æ ¹</span>
<span class="token keyword">const</span> roots <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">getTreeRepository</span><span class="token punctuation">(</span>Category<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">findRoots</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">// è¿”å›å­ Tree</span>
<span class="token keyword">const</span> a11 <span class="token operator">=</span> <span class="token keyword">await</span> Category<span class="token punctuation">.</span><span class="token function">findOne</span><span class="token punctuation">(</span><span class="token punctuation">{</span> name<span class="token operator">:</span> <span class="token string">'a11'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> children <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">getTreeRepository</span><span class="token punctuation">(</span>Category<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">findDescendantsTree</span><span class="token punctuation">(</span>a11<span class="token punctuation">)</span>

<span class="token comment">// è¿”å›çˆ¶çº§</span>
<span class="token keyword">const</span> a11 <span class="token operator">=</span> <span class="token keyword">await</span> Category<span class="token punctuation">.</span><span class="token function">findOne</span><span class="token punctuation">(</span><span class="token punctuation">{</span> name<span class="token operator">:</span> <span class="token string">'a11'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> parent <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">getTreeRepository</span><span class="token punctuation">(</span>Category<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">findAncestorsTree</span><span class="token punctuation">(</span>a11<span class="token punctuation">)</span>
</code></pre></div><p>æ›´å¤šæŸ¥è¯¢å‚è€ƒ <a href="https://typeorm.io/#/tree-entities/%E4%BD%BF%E7%94%A8%E6%A0%91%E5%AE%9E%E4%BD%93" target="_blank" rel="noopener noreferrer">ä½¿ç”¨æ ‘å®ä½“<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>ã€‚</p> <h2 id="å…³ç³»"><a href="#å…³ç³»" class="header-anchor">#</a> å…³ç³»</h2> <p>å…³ç³»å¯ä»¥å¸®åŠ©ä½ è½»æ¾åœ°ä¸ç›¸å…³å®ä½“åˆä½œã€‚</p> <h3 id="joincolumn-jointable"><a href="#joincolumn-jointable" class="header-anchor">#</a> JoinColumn &amp; JoinTable</h3> <p><code>@JoinColumn</code> ä¸ä»…å®šä¹‰äº†å…³ç³»çš„å“ªä¸€ä¾§åŒ…å«å¸¦æœ‰å¤–é”®çš„è¿æ¥åˆ—ï¼Œè¿˜å…è®¸è‡ªå®šä¹‰è¿æ¥åˆ—åå’Œå¼•ç”¨çš„åˆ—åã€‚</p> <p>å½“æˆ‘ä»¬è®¾ç½® <code>@JoinColumn</code> æ—¶ï¼Œå®ƒä¼šè‡ªåŠ¨åœ¨æ•°æ®åº“ä¸­åˆ›å»ºä¸€ä¸ªåä¸º <code>propertyName + referenceColumnName</code> çš„åˆ—ã€‚</p> <p><code>@JoinTable</code> ç”¨äº â€œå¤šå¯¹å¤šâ€ å…³ç³»ï¼Œè”ç»“è¡¨æ˜¯ç”± TypeORM è‡ªåŠ¨åˆ›å»ºçš„ä¸€ä¸ªç‰¹æ®Šçš„å•ç‹¬è¡¨ã€‚</p> <h3 id="å¤šå¯¹ä¸€å’Œä¸€å¯¹å¤š"><a href="#å¤šå¯¹ä¸€å’Œä¸€å¯¹å¤š" class="header-anchor">#</a> å¤šå¯¹ä¸€å’Œä¸€å¯¹å¤š</h3> <p>å¯ä»¥åœ¨ <code>@ManyToOne</code> / <code>@OneToMany</code> å…³ç³»ä¸­çœç•¥ <code>@JoinColumn</code>ï¼Œé™¤ééœ€è¦è‡ªå®šä¹‰å…³è”åˆ—åœ¨æ•°æ®åº“ä¸­çš„åç§°ã€‚</p> <p><code>@ManyToOne</code> å¯ä»¥å•ç‹¬ä½¿ç”¨ï¼Œä½† <code>@OneToMany</code> å¿…é¡»æ­é… <code>@ManyToOne</code> ä½¿ç”¨ã€‚</p> <p>åœ¨è®¾ç½® <code>@ManyToOne</code> çš„åœ°æ–¹ï¼Œç›¸å…³å®ä½“å°†ä¼šæœ‰ â€œå…³è” idâ€ å’Œå¤–é”®ã€‚</p></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/shanyuhai123/documents/edit/master/docs/backend/nestjs/typeorm.md" target="_blank" rel="noopener noreferrer">ç¼–è¾‘æ–‡æ¡£ï¼</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="last-updated"><span class="prefix">ä¸Šæ¬¡æ›´æ–°:</span> <span class="time">2021å¹´3æœˆ24æ—¥æ˜ŸæœŸä¸‰ä¸Šåˆ10ç‚¹52åˆ†</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      â†
      <a href="/backend/nestjs/architecture.html" class="prev">
        æ¶æ„
      </a></span> <!----></p></div> </main></div><div class="global-ui"><!----><!----></div></div>
    <script src="/assets/js/app.a7a57cfd.js" defer></script><script src="/assets/js/2.cc873f3c.js" defer></script><script src="/assets/js/36.e93c94a9.js" defer></script><script src="/assets/js/4.56440d0a.js" defer></script>
  </body>
</html>
