<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="generator" content="VuePress 2.0.0-beta.24">
    <link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="icon" href="/favicon.ico"><link rel="manifest" href="/manifest.json"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.5.1/katex.min.css"><meta name="theme-color" content="#ffffff"><meta name="google-site-verification" content="Ld_AEWr30siza2LmmZ12csitRGsSj9gqqEAch0UXkTc"><title>ä½¿ç”¨ Docker æ­å»º ETCD | é£è·ƒé«˜å±±ä¸å¤§æ´‹çš„é±¼</title><meta name="description" content="é£è·ƒé«˜å±±ä¸å¤§æ´‹çš„é±¼çš„æ–‡æ¡£, vuepress æ–‡æ¡£">
    <link rel="modulepreload" href="/assets/app.a242ecf4.js"><link rel="modulepreload" href="/assets/etcd.html.afac7f58.js"><link rel="modulepreload" href="/assets/etcd.html.960b7690.js">
    <link rel="stylesheet" href="/assets/style.bc9864ce.css">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme-container"><header class="navbar"><div class="toggle-sidebar-button" title="toggle sidebar" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a href="/" class=""><img class="logo" src="/hero.jpg" alt="é£è·ƒé«˜å±±ä¸å¤§æ´‹çš„é±¼"><span class="site-name can-hide">é£è·ƒé«˜å±±ä¸å¤§æ´‹çš„é±¼</span></a></span><div class="navbar-links-wrapper" style=""><!--[--><!--]--><nav class="navbar-links can-hide"><!--[--><div class="navbar-links-item"><a href="/" class="nav-link" aria-label="é¦–é¡µ"><!--[--><!--]--> é¦–é¡µ <!--[--><!--]--></a></div><div class="navbar-links-item"><a href="/pre-reading.html" class="nav-link" aria-label="å…ˆçœ‹"><!--[--><!--]--> å…ˆçœ‹ <!--[--><!--]--></a></div><div class="navbar-links-item"><a href="/computer/" class="nav-link" aria-label="è®¡ç®—æœº"><!--[--><!--]--> è®¡ç®—æœº <!--[--><!--]--></a></div><div class="navbar-links-item"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="åŸºçŸ³"><span class="title">åŸºçŸ³</span><span class="arrow down"></span></button><button class="mobile-dropdown-title" type="button" aria-label="åŸºçŸ³"><span class="title">åŸºçŸ³</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="nav-dropdown"><!--[--><li class="dropdown-item"><a href="/cornerstone/math/" class="nav-link" aria-label="æ•°å­¦"><!--[--><!--]--> æ•°å­¦ <!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-links-item"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="ç³»ç»Ÿ"><span class="title">ç³»ç»Ÿ</span><span class="arrow down"></span></button><button class="mobile-dropdown-title" type="button" aria-label="ç³»ç»Ÿ"><span class="title">ç³»ç»Ÿ</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="nav-dropdown"><!--[--><li class="dropdown-item"><a href="/os/linux/" class="nav-link" aria-label="Linux"><!--[--><!--]--> Linux <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/os/manjaro/" class="nav-link" aria-label="Manjaro"><!--[--><!--]--> Manjaro <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/os/ubuntu/" class="nav-link" aria-label="Ubuntu"><!--[--><!--]--> Ubuntu <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/os/centos/" class="nav-link" aria-label="CentOS"><!--[--><!--]--> CentOS <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/os/kubernetes/" class="nav-link" aria-label="Kubernetes"><!--[--><!--]--> Kubernetes <!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-links-item"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="å‰ç«¯"><span class="title">å‰ç«¯</span><span class="arrow down"></span></button><button class="mobile-dropdown-title" type="button" aria-label="å‰ç«¯"><span class="title">å‰ç«¯</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="nav-dropdown"><!--[--><li class="dropdown-item"><a href="/frontend/javascript/" class="nav-link" aria-label="JavaScript"><!--[--><!--]--> JavaScript <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/frontend/typescript/" class="nav-link" aria-label="TypeScript"><!--[--><!--]--> TypeScript <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/frontend/css/" class="nav-link" aria-label="CSS"><!--[--><!--]--> CSS <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/frontend/canvas/" class="nav-link" aria-label="Canvas"><!--[--><!--]--> Canvas <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/frontend/vue/" class="nav-link" aria-label="Vue"><!--[--><!--]--> Vue <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/frontend/vite/" class="nav-link" aria-label="Vite"><!--[--><!--]--> Vite <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/frontend/nuxtjs/" class="nav-link" aria-label="NuxtJS"><!--[--><!--]--> NuxtJS <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/frontend/webpack/" class="nav-link" aria-label="Webpack"><!--[--><!--]--> Webpack <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/frontend/flutter/" class="nav-link" aria-label="Flutter"><!--[--><!--]--> Flutter <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/frontend/d3js/" class="nav-link" aria-label="D3"><!--[--><!--]--> D3 <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/frontend/jest/" class="nav-link" aria-label="Jest"><!--[--><!--]--> Jest <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/frontend/weapp/" class="nav-link" aria-label="WeApp"><!--[--><!--]--> WeApp <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/frontend/utils/" class="nav-link" aria-label="Utils"><!--[--><!--]--> Utils <!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-links-item"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="åç«¯"><span class="title">åç«¯</span><span class="arrow down"></span></button><button class="mobile-dropdown-title" type="button" aria-label="åç«¯"><span class="title">åç«¯</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="nav-dropdown"><!--[--><li class="dropdown-item"><a href="/backend/nodejs/" class="nav-link" aria-label="Nodejs"><!--[--><!--]--> Nodejs <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/backend/nestjs/" class="nav-link" aria-label="Nestjs"><!--[--><!--]--> Nestjs <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/backend/golang/" class="nav-link" aria-label="Golang"><!--[--><!--]--> Golang <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/backend/nginx/" class="nav-link" aria-label="Nginx"><!--[--><!--]--> Nginx <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/backend/traefik/" class="nav-link" aria-label="Traefik"><!--[--><!--]--> Traefik <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/backend/mysql/" class="nav-link" aria-label="MySQL"><!--[--><!--]--> MySQL <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/backend/mongodb/" class="nav-link" aria-label="MongoDB"><!--[--><!--]--> MongoDB <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/backend/redis/" class="nav-link" aria-label="Redis"><!--[--><!--]--> Redis <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/backend/docker/" class="nav-link router-link-active" aria-label="Docker"><!--[--><!--]--> Docker <!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-links-item"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="ç®—æ³•"><span class="title">ç®—æ³•</span><span class="arrow down"></span></button><button class="mobile-dropdown-title" type="button" aria-label="ç®—æ³•"><span class="title">ç®—æ³•</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="nav-dropdown"><!--[--><li class="dropdown-item"><a href="/algorithms/sort/" class="nav-link" aria-label="æ’åº"><!--[--><!--]--> æ’åº <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/algorithms/divide-and-conquer/" class="nav-link" aria-label="åˆ†è€Œæ²»ä¹‹"><!--[--><!--]--> åˆ†è€Œæ²»ä¹‹ <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/algorithms/dynamic-programming/" class="nav-link" aria-label="åŠ¨æ€è§„åˆ’"><!--[--><!--]--> åŠ¨æ€è§„åˆ’ <!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-links-item"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="è®¾è®¡"><span class="title">è®¾è®¡</span><span class="arrow down"></span></button><button class="mobile-dropdown-title" type="button" aria-label="è®¾è®¡"><span class="title">è®¾è®¡</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="nav-dropdown"><!--[--><li class="dropdown-item"><a href="/design/pixel/" class="nav-link" aria-label="åƒç´ é£"><!--[--><!--]--> åƒç´ é£ <!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-links-item"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="å¼€å‘å·¥å…·"><span class="title">å¼€å‘å·¥å…·</span><span class="arrow down"></span></button><button class="mobile-dropdown-title" type="button" aria-label="å¼€å‘å·¥å…·"><span class="title">å¼€å‘å·¥å…·</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="nav-dropdown"><!--[--><li class="dropdown-item"><a href="/tools/git/" class="nav-link" aria-label="Git"><!--[--><!--]--> Git <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/tools/github/" class="nav-link" aria-label="Github"><!--[--><!--]--> Github <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/tools/vscode/" class="nav-link" aria-label="VSCode"><!--[--><!--]--> VSCode <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/tools/chrome/" class="nav-link" aria-label="Chrome"><!--[--><!--]--> Chrome <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/tools/google/" class="nav-link" aria-label="Google"><!--[--><!--]--> Google <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/tools/bookmark-scripts/" class="nav-link" aria-label="Bookmark scripts"><!--[--><!--]--> Bookmark scripts <!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-links-item"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="æ›´å¤š"><span class="title">æ›´å¤š</span><span class="arrow down"></span></button><button class="mobile-dropdown-title" type="button" aria-label="æ›´å¤š"><span class="title">æ›´å¤š</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="nav-dropdown"><!--[--><li class="dropdown-item"><a href="/more/navigation.html" class="nav-link" aria-label="å¯¼èˆª ğŸ‰"><!--[--><!--]--> å¯¼èˆª ğŸ‰ <!--[--><!--]--></a></li><li class="dropdown-item"><a class="nav-link external" href="https://shanyuhai123.github.io/vuepress-plugin-auto-sidebar/zh/" rel="noopener noreferrer" target="_blank" aria-label="VuePress ä¾§è¾¹æ æ’ä»¶"><!--[--><!--]--> VuePress ä¾§è¾¹æ æ’ä»¶ <span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" ariahidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span><!--[--><!--]--></a></li><li class="dropdown-item"><a class="nav-link external" href="https://vuepress.vuejs.org/zh/" rel="noopener noreferrer" target="_blank" aria-label="VuePress å®˜ç½‘"><!--[--><!--]--> VuePress å®˜ç½‘ <span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" ariahidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span><!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-links-item"><a class="nav-link external" href="https://github.com/shanyuhai123/documents" rel="noopener noreferrer" target="_blank" aria-label="GitHub"><!--[--><!--]--> GitHub <span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" ariahidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span><!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><button class="toggle-dark-button" title="toggle dark mode"><svg style="" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg style="display:none;" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><form class="search-box" role="search"><input type="search" placeholder="æœç´¢" autocomplete="off" spellcheck="false" value><!----></form></div></header><div class="sidebar-mask"></div><aside class="sidebar"><nav class="navbar-links"><!--[--><div class="navbar-links-item"><a href="/" class="nav-link" aria-label="é¦–é¡µ"><!--[--><!--]--> é¦–é¡µ <!--[--><!--]--></a></div><div class="navbar-links-item"><a href="/pre-reading.html" class="nav-link" aria-label="å…ˆçœ‹"><!--[--><!--]--> å…ˆçœ‹ <!--[--><!--]--></a></div><div class="navbar-links-item"><a href="/computer/" class="nav-link" aria-label="è®¡ç®—æœº"><!--[--><!--]--> è®¡ç®—æœº <!--[--><!--]--></a></div><div class="navbar-links-item"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="åŸºçŸ³"><span class="title">åŸºçŸ³</span><span class="arrow down"></span></button><button class="mobile-dropdown-title" type="button" aria-label="åŸºçŸ³"><span class="title">åŸºçŸ³</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="nav-dropdown"><!--[--><li class="dropdown-item"><a href="/cornerstone/math/" class="nav-link" aria-label="æ•°å­¦"><!--[--><!--]--> æ•°å­¦ <!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-links-item"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="ç³»ç»Ÿ"><span class="title">ç³»ç»Ÿ</span><span class="arrow down"></span></button><button class="mobile-dropdown-title" type="button" aria-label="ç³»ç»Ÿ"><span class="title">ç³»ç»Ÿ</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="nav-dropdown"><!--[--><li class="dropdown-item"><a href="/os/linux/" class="nav-link" aria-label="Linux"><!--[--><!--]--> Linux <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/os/manjaro/" class="nav-link" aria-label="Manjaro"><!--[--><!--]--> Manjaro <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/os/ubuntu/" class="nav-link" aria-label="Ubuntu"><!--[--><!--]--> Ubuntu <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/os/centos/" class="nav-link" aria-label="CentOS"><!--[--><!--]--> CentOS <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/os/kubernetes/" class="nav-link" aria-label="Kubernetes"><!--[--><!--]--> Kubernetes <!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-links-item"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="å‰ç«¯"><span class="title">å‰ç«¯</span><span class="arrow down"></span></button><button class="mobile-dropdown-title" type="button" aria-label="å‰ç«¯"><span class="title">å‰ç«¯</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="nav-dropdown"><!--[--><li class="dropdown-item"><a href="/frontend/javascript/" class="nav-link" aria-label="JavaScript"><!--[--><!--]--> JavaScript <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/frontend/typescript/" class="nav-link" aria-label="TypeScript"><!--[--><!--]--> TypeScript <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/frontend/css/" class="nav-link" aria-label="CSS"><!--[--><!--]--> CSS <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/frontend/canvas/" class="nav-link" aria-label="Canvas"><!--[--><!--]--> Canvas <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/frontend/vue/" class="nav-link" aria-label="Vue"><!--[--><!--]--> Vue <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/frontend/vite/" class="nav-link" aria-label="Vite"><!--[--><!--]--> Vite <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/frontend/nuxtjs/" class="nav-link" aria-label="NuxtJS"><!--[--><!--]--> NuxtJS <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/frontend/webpack/" class="nav-link" aria-label="Webpack"><!--[--><!--]--> Webpack <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/frontend/flutter/" class="nav-link" aria-label="Flutter"><!--[--><!--]--> Flutter <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/frontend/d3js/" class="nav-link" aria-label="D3"><!--[--><!--]--> D3 <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/frontend/jest/" class="nav-link" aria-label="Jest"><!--[--><!--]--> Jest <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/frontend/weapp/" class="nav-link" aria-label="WeApp"><!--[--><!--]--> WeApp <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/frontend/utils/" class="nav-link" aria-label="Utils"><!--[--><!--]--> Utils <!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-links-item"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="åç«¯"><span class="title">åç«¯</span><span class="arrow down"></span></button><button class="mobile-dropdown-title" type="button" aria-label="åç«¯"><span class="title">åç«¯</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="nav-dropdown"><!--[--><li class="dropdown-item"><a href="/backend/nodejs/" class="nav-link" aria-label="Nodejs"><!--[--><!--]--> Nodejs <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/backend/nestjs/" class="nav-link" aria-label="Nestjs"><!--[--><!--]--> Nestjs <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/backend/golang/" class="nav-link" aria-label="Golang"><!--[--><!--]--> Golang <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/backend/nginx/" class="nav-link" aria-label="Nginx"><!--[--><!--]--> Nginx <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/backend/traefik/" class="nav-link" aria-label="Traefik"><!--[--><!--]--> Traefik <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/backend/mysql/" class="nav-link" aria-label="MySQL"><!--[--><!--]--> MySQL <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/backend/mongodb/" class="nav-link" aria-label="MongoDB"><!--[--><!--]--> MongoDB <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/backend/redis/" class="nav-link" aria-label="Redis"><!--[--><!--]--> Redis <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/backend/docker/" class="nav-link router-link-active" aria-label="Docker"><!--[--><!--]--> Docker <!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-links-item"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="ç®—æ³•"><span class="title">ç®—æ³•</span><span class="arrow down"></span></button><button class="mobile-dropdown-title" type="button" aria-label="ç®—æ³•"><span class="title">ç®—æ³•</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="nav-dropdown"><!--[--><li class="dropdown-item"><a href="/algorithms/sort/" class="nav-link" aria-label="æ’åº"><!--[--><!--]--> æ’åº <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/algorithms/divide-and-conquer/" class="nav-link" aria-label="åˆ†è€Œæ²»ä¹‹"><!--[--><!--]--> åˆ†è€Œæ²»ä¹‹ <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/algorithms/dynamic-programming/" class="nav-link" aria-label="åŠ¨æ€è§„åˆ’"><!--[--><!--]--> åŠ¨æ€è§„åˆ’ <!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-links-item"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="è®¾è®¡"><span class="title">è®¾è®¡</span><span class="arrow down"></span></button><button class="mobile-dropdown-title" type="button" aria-label="è®¾è®¡"><span class="title">è®¾è®¡</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="nav-dropdown"><!--[--><li class="dropdown-item"><a href="/design/pixel/" class="nav-link" aria-label="åƒç´ é£"><!--[--><!--]--> åƒç´ é£ <!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-links-item"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="å¼€å‘å·¥å…·"><span class="title">å¼€å‘å·¥å…·</span><span class="arrow down"></span></button><button class="mobile-dropdown-title" type="button" aria-label="å¼€å‘å·¥å…·"><span class="title">å¼€å‘å·¥å…·</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="nav-dropdown"><!--[--><li class="dropdown-item"><a href="/tools/git/" class="nav-link" aria-label="Git"><!--[--><!--]--> Git <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/tools/github/" class="nav-link" aria-label="Github"><!--[--><!--]--> Github <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/tools/vscode/" class="nav-link" aria-label="VSCode"><!--[--><!--]--> VSCode <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/tools/chrome/" class="nav-link" aria-label="Chrome"><!--[--><!--]--> Chrome <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/tools/google/" class="nav-link" aria-label="Google"><!--[--><!--]--> Google <!--[--><!--]--></a></li><li class="dropdown-item"><a href="/tools/bookmark-scripts/" class="nav-link" aria-label="Bookmark scripts"><!--[--><!--]--> Bookmark scripts <!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-links-item"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="æ›´å¤š"><span class="title">æ›´å¤š</span><span class="arrow down"></span></button><button class="mobile-dropdown-title" type="button" aria-label="æ›´å¤š"><span class="title">æ›´å¤š</span><span class="right arrow"></span></button><!--[--><ul style="display:none;" class="nav-dropdown"><!--[--><li class="dropdown-item"><a href="/more/navigation.html" class="nav-link" aria-label="å¯¼èˆª ğŸ‰"><!--[--><!--]--> å¯¼èˆª ğŸ‰ <!--[--><!--]--></a></li><li class="dropdown-item"><a class="nav-link external" href="https://shanyuhai123.github.io/vuepress-plugin-auto-sidebar/zh/" rel="noopener noreferrer" target="_blank" aria-label="VuePress ä¾§è¾¹æ æ’ä»¶"><!--[--><!--]--> VuePress ä¾§è¾¹æ æ’ä»¶ <span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" ariahidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span><!--[--><!--]--></a></li><li class="dropdown-item"><a class="nav-link external" href="https://vuepress.vuejs.org/zh/" rel="noopener noreferrer" target="_blank" aria-label="VuePress å®˜ç½‘"><!--[--><!--]--> VuePress å®˜ç½‘ <span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" ariahidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span><!--[--><!--]--></a></li><!--]--></ul><!--]--></div></div><div class="navbar-links-item"><a class="nav-link external" href="https://github.com/shanyuhai123/documents" rel="noopener noreferrer" target="_blank" aria-label="GitHub"><!--[--><!--]--> GitHub <span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" ariahidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span><!--[--><!--]--></a></div><!--]--></nav><!--[--><!--]--><ul class="sidebar-links"><!--[--><!--[--><p class="sidebar-heading sidebar-item active">DOCKER</p><ul class=""><li><!--[--><a href="/backend/docker/" class="nav-link router-link-active sidebar-item" aria-label="äººç”Ÿè‹¦çŸ­ï¼Œæˆ‘ç”¨ Docker"><!--[--><!--]--> äººç”Ÿè‹¦çŸ­ï¼Œæˆ‘ç”¨ Docker <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/backend/docker/dockerfile.html" class="nav-link sidebar-item" aria-label="Dockerfile"><!--[--><!--]--> Dockerfile <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/backend/docker/image.html" class="nav-link sidebar-item" aria-label="äº†è§£ Docker é•œåƒ"><!--[--><!--]--> äº†è§£ Docker é•œåƒ <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/backend/docker/container.html" class="nav-link sidebar-item" aria-label="äº†è§£ Docker å®¹å™¨"><!--[--><!--]--> äº†è§£ Docker å®¹å™¨ <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/backend/docker/volumes.html" class="nav-link sidebar-item" aria-label="äº†è§£ Docker æ•°æ®å·"><!--[--><!--]--> äº†è§£ Docker æ•°æ®å· <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a href="/backend/docker/docker-compose.html" class="nav-link sidebar-item" aria-label="Docker Compose ç®¡ç†å¤šä¸ªæœåŠ¡"><!--[--><!--]--> Docker Compose ç®¡ç†å¤šä¸ªæœåŠ¡ <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/backend/docker/etcd.html" class="router-link-active router-link-exact-active nav-link router-link-active sidebar-item active" aria-label="ä½¿ç”¨ Docker æ­å»º ETCD"><!--[--><!--]--> ä½¿ç”¨ Docker æ­å»º ETCD <!--[--><!--]--></a><ul class="sidebar-sub-items"><li><!--[--><a aria-current="page" href="/backend/docker/etcd.html#etcd-åŸºç¡€æ¦‚å¿µ" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="ETCD åŸºç¡€æ¦‚å¿µ"><!--[--><!--]--> ETCD åŸºç¡€æ¦‚å¿µ <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/backend/docker/etcd.html#éƒ¨ç½²-etcd" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="éƒ¨ç½² ETCD"><!--[--><!--]--> éƒ¨ç½² ETCD <!--[--><!--]--></a><ul class="sidebar-sub-items"><li><!--[--><a aria-current="page" href="/backend/docker/etcd.html#å‡†å¤‡" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="å‡†å¤‡"><!--[--><!--]--> å‡†å¤‡ <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/backend/docker/etcd.html#åŸºäº-ip-éƒ¨ç½²" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="åŸºäº IP éƒ¨ç½²"><!--[--><!--]--> åŸºäº IP éƒ¨ç½² <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/backend/docker/etcd.html#åŸºäº-dns-éƒ¨ç½²" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="åŸºäº DNS éƒ¨ç½²"><!--[--><!--]--> åŸºäº DNS éƒ¨ç½² <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/backend/docker/etcd.html#æ ¡éªŒç»“æœ" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="æ ¡éªŒç»“æœ"><!--[--><!--]--> æ ¡éªŒç»“æœ <!--[--><!--]--></a><!----><!--]--></li></ul><!--]--></li><li><!--[--><a aria-current="page" href="/backend/docker/etcd.html#æ•°æ®" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="æ•°æ®"><!--[--><!--]--> æ•°æ® <!--[--><!--]--></a><ul class="sidebar-sub-items"><li><!--[--><a aria-current="page" href="/backend/docker/etcd.html#crud" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="CRUD"><!--[--><!--]--> CRUD <!--[--><!--]--></a><!----><!--]--></li><li><!--[--><a aria-current="page" href="/backend/docker/etcd.html#watch" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="WATCH"><!--[--><!--]--> WATCH <!--[--><!--]--></a><!----><!--]--></li></ul><!--]--></li><li><!--[--><a aria-current="page" href="/backend/docker/etcd.html#å¤„ç†é—®é¢˜" class="router-link-active router-link-exact-active nav-link sidebar-item" aria-label="å¤„ç†é—®é¢˜"><!--[--><!--]--> å¤„ç†é—®é¢˜ <!--[--><!--]--></a><!----><!--]--></li></ul><!--]--></li><li><!--[--><a href="/backend/docker/private-registry.html" class="nav-link sidebar-item" aria-label="ä½¿ç”¨ Harbor æ„å»ºç§æœ‰é•œåƒä»“åº“"><!--[--><!--]--> ä½¿ç”¨ Harbor æ„å»ºç§æœ‰é•œåƒä»“åº“ <!--[--><!--]--></a><!----><!--]--></li></ul><!--]--><!--]--></ul><!--[--><!--]--></aside><!--[--><main class="page"><!--[--><!--]--><div class="theme-default-content"><!--[--><h1 id="ä½¿ç”¨-docker-æ­å»º-etcd" tabindex="-1"><a class="header-anchor" href="#ä½¿ç”¨-docker-æ­å»º-etcd" aria-hidden="true">#</a> ä½¿ç”¨ Docker æ­å»º ETCD</h1><h2 id="etcd-åŸºç¡€æ¦‚å¿µ" tabindex="-1"><a class="header-anchor" href="#etcd-åŸºç¡€æ¦‚å¿µ" aria-hidden="true">#</a> ETCD åŸºç¡€æ¦‚å¿µ</h2><ul><li>Raftï¼šetcd æ‰€é‡‡ç”¨çš„ä¿è¯åˆ†å¸ƒå¼ç³»ç»Ÿå¼ºä¸€è‡´æ€§çš„ç®—æ³•</li><li>Nodeï¼šä¸€ä¸ª Raft çŠ¶æ€å®ä¾‹æœº</li><li>Memberï¼šä¸€ä¸ª etcd å®ä¾‹ã€‚å®ƒç®¡ç†ç€ä¸€ä¸ª Nodeï¼Œå¹¶ä¸”å¯ä»¥ä¸ºå®¢æˆ·ç«¯è¯·æ±‚æä¾›æœåŠ¡</li><li>Clusterï¼šç”±å¤šä¸ª Member æ„æˆå¯ä»¥ååŒå·¥ä½œçš„ etcd é›†ç¾¤</li><li>Peerï¼šå¯¹åŒä¸€ä¸ª etcd é›†ç¾¤ä¸­çš„å¦å¤–ä¸€ä¸ª Member çš„ç§°å‘¼</li><li>Clientï¼šå‘ etcd é›†ç¾¤å‘é€ HTTP è¯·æ±‚çš„å®¢æˆ·ç«¯</li><li>WALï¼šé¢„å†™å¼æ—¥å¿—ï¼Œetcd ç”¨äºæŒä¹…åŒ–å­˜å‚¨çš„æ—¥å¿—æ ¼å¼</li><li>snapshotï¼šetcd é˜²æ­¢ WAL æ–‡ä»¶è¿‡å¤šè€Œè®¾ç½®çš„å¿«ç…§ï¼Œå­˜å‚¨ etcd æ•°æ®çŠ¶æ€</li><li>Proxyï¼šetcd çš„ä¸€ç§æ¨¡å¼ï¼Œä¸º etcd é›†ç¾¤æä¾›åå‘ä»£ç†æœåŠ¡</li><li>Leaderï¼šRaft ç®—æ³•ä¸­é€šè¿‡ç«é€‰è€Œäº§ç”Ÿçš„å¤„ç†æ‰€æœ‰æ•°æ®çš„èŠ‚ç‚¹</li><li>Followerï¼šç«é€‰å¤±è´¥çš„èŠ‚ç‚¹ä½œä¸º Raft ä¸­çš„ä»å±èŠ‚ç‚¹ï¼Œä¸ºç®—æ³•æä¾›å¼ºä¸€è‡´æ€§ä¿è¯</li><li>Candidateï¼šå½“ Follower è¶…è¿‡ä¸€å®šæ—¶é—´æ¥æ”¶ä¸åˆ° Leader çš„å¿ƒè·³æ—¶è½¬å˜ä¸º Candidate å¼€å§‹ç«é€‰</li><li>Termï¼šæŸä¸ªèŠ‚ç‚¹æˆä¸º Leader åˆ°ä¸‹ä¸€æ¬¡ç«é€‰æ—¶é—´ï¼Œç§°ä¸ºä¸€ä¸ª Term</li><li>Indexï¼šæ•°æ®é¡¹ç¼–å·ã€‚Raft ä¸­é€šè¿‡ Term å’Œ Index æ¥å®šä½æ•°æ®</li></ul><h2 id="éƒ¨ç½²-etcd" tabindex="-1"><a class="header-anchor" href="#éƒ¨ç½²-etcd" aria-hidden="true">#</a> éƒ¨ç½² ETCD</h2><p>åœ¨éƒ¨ç½²æ—¶ï¼Œä¸ç¡®å®šå…¶ä»–æˆå‘˜ IP æ˜¯å¸¸è§çš„ï¼Œå¯ä»¥ä½¿ç”¨<a href="https://etcd.io/docs/v3.4.0/dev-internal/discovery_protocol/" target="_blank" rel="noopener noreferrer">åŠ¨æ€å‘ç°<span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" ariahidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span></a>çš„æ–¹å¼è§£å†³ã€‚</p><h3 id="å‡†å¤‡" tabindex="-1"><a class="header-anchor" href="#å‡†å¤‡" aria-hidden="true">#</a> å‡†å¤‡</h3><p>æ‹‰å–é•œåƒï¼š</p><div class="language-bash ext-sh"><pre class="language-bash"><code>docker pull bitnami/etcd:3.4.14
</code></pre></div><p>ç¡®è®¤ ETCD èŠ‚ç‚¹æ•°é‡ï¼Œä¾‹å¦‚ä¸‰ä¸ªï¼š</p><div class="language-bash ext-sh"><pre class="language-bash"><code><span class="token function">curl</span> https://discovery.etcd.io/new?size<span class="token operator">=</span><span class="token number">3</span>
<span class="token comment"># https://discovery.etcd.io/fbcc7b00dbd102b74d8daa1781fbb941</span>
</code></pre></div><p>ç¯å¢ƒå˜é‡ï¼š</p><div class="language-bash ext-sh"><pre class="language-bash"><code><span class="token assign-left variable">REGISTRY</span><span class="token operator">=</span>bitnami/etcd
<span class="token assign-left variable">ETCD_VERSION</span><span class="token operator">=</span><span class="token number">3.4</span>.14
<span class="token assign-left variable">TOKEN</span><span class="token operator">=</span>etcd-token
<span class="token assign-left variable">CLUSTER_STATE</span><span class="token operator">=</span>new
<span class="token assign-left variable">NAME_1</span><span class="token operator">=</span>etcd-n1
<span class="token assign-left variable">NAME_2</span><span class="token operator">=</span>etcd-n2
<span class="token assign-left variable">NAME_3</span><span class="token operator">=</span>etcd-n3
<span class="token assign-left variable">HOST_1</span><span class="token operator">=</span><span class="token number">10.0</span>.0.137
<span class="token assign-left variable">HOST_2</span><span class="token operator">=</span><span class="token number">10.0</span>.0.138
<span class="token assign-left variable">HOST_3</span><span class="token operator">=</span><span class="token number">10.0</span>.0.139
<span class="token assign-left variable">DISCOVERY</span><span class="token operator">=</span>https://discovery.etcd.io/fbcc7b00dbd102b74d8daa1781fbb941
</code></pre></div><h3 id="åŸºäº-ip-éƒ¨ç½²" tabindex="-1"><a class="header-anchor" href="#åŸºäº-ip-éƒ¨ç½²" aria-hidden="true">#</a> åŸºäº IP éƒ¨ç½²</h3><p><code>node1</code>ï¼š</p><div class="language-bash ext-sh"><pre class="language-bash"><code>docker stop etcd <span class="token operator">&amp;&amp;</span> docker <span class="token function">rm</span> etcd
<span class="token assign-left variable">THIS_NAME</span><span class="token operator">=</span><span class="token variable">${NAME_1}</span>
<span class="token assign-left variable">THIS_IP</span><span class="token operator">=</span><span class="token variable">${HOST_1}</span>
docker run --name etcd -d <span class="token punctuation">\</span>
  -p <span class="token number">2379</span>:2379 <span class="token punctuation">\</span>
  -p <span class="token number">2380</span>:2380 <span class="token punctuation">\</span>
  --env <span class="token assign-left variable">ALLOW_NONE_AUTHENTICATION</span><span class="token operator">=</span>yes <span class="token punctuation">\</span>
  --env <span class="token assign-left variable">ETCD_LISTEN_CLIENT_URLS</span><span class="token operator">=</span>http://0.0.0.0:2379 <span class="token punctuation">\</span>
  --env <span class="token assign-left variable">ETCD_ADVERTISE_CLIENT_URLS</span><span class="token operator">=</span>http://<span class="token variable">${THIS_IP}</span>:2379 <span class="token punctuation">\</span>
  <span class="token variable">${REGISTRY}</span><span class="token builtin class-name">:</span><span class="token variable">${ETCD_VERSION}</span> <span class="token punctuation">\</span>
   etcd <span class="token punctuation">\</span>
    --name <span class="token variable">${THIS_NAME}</span> <span class="token punctuation">\</span>
    --initial-advertise-peer-urls http://<span class="token variable">${THIS_IP}</span>:2380 --listen-peer-urls http://0.0.0.0:2380 <span class="token punctuation">\</span>
  	--discovery <span class="token variable">${DISCOVERY}</span> <span class="token punctuation">\</span>
  	--initial-cluster-state <span class="token variable">${CLUSTER_STATE}</span> --initial-cluster-token <span class="token variable">${TOKEN}</span>
</code></pre></div><p><code>node2</code>ï¼š</p><div class="language-bash ext-sh"><pre class="language-bash"><code>docker stop etcd <span class="token operator">&amp;&amp;</span> docker <span class="token function">rm</span> etcd
<span class="token assign-left variable">THIS_NAME</span><span class="token operator">=</span><span class="token variable">${NAME_2}</span>
<span class="token assign-left variable">THIS_IP</span><span class="token operator">=</span><span class="token variable">${HOST_2}</span>
docker run --name etcd -d <span class="token punctuation">\</span>
  -p <span class="token number">2379</span>:2379 <span class="token punctuation">\</span>
  -p <span class="token number">2380</span>:2380 <span class="token punctuation">\</span>
  --env <span class="token assign-left variable">ALLOW_NONE_AUTHENTICATION</span><span class="token operator">=</span>yes <span class="token punctuation">\</span>
  --env <span class="token assign-left variable">ETCD_LISTEN_CLIENT_URLS</span><span class="token operator">=</span>http://0.0.0.0:2379 <span class="token punctuation">\</span>
  --env <span class="token assign-left variable">ETCD_ADVERTISE_CLIENT_URLS</span><span class="token operator">=</span>http://<span class="token variable">${THIS_IP}</span>:2379 <span class="token punctuation">\</span>
  <span class="token variable">${REGISTRY}</span><span class="token builtin class-name">:</span><span class="token variable">${ETCD_VERSION}</span> <span class="token punctuation">\</span>
   etcd <span class="token punctuation">\</span>
    --name <span class="token variable">${THIS_NAME}</span> <span class="token punctuation">\</span>
    --initial-advertise-peer-urls http://<span class="token variable">${THIS_IP}</span>:2380 --listen-peer-urls http://0.0.0.0:2380 <span class="token punctuation">\</span>
  	--discovery <span class="token variable">${DISCOVERY}</span> <span class="token punctuation">\</span>
  	--initial-cluster-state <span class="token variable">${CLUSTER_STATE}</span> --initial-cluster-token <span class="token variable">${TOKEN}</span>
</code></pre></div><p><code>node3</code>ï¼š</p><div class="language-bash ext-sh"><pre class="language-bash"><code>docker stop etcd <span class="token operator">&amp;&amp;</span> docker <span class="token function">rm</span> etcd
<span class="token assign-left variable">THIS_NAME</span><span class="token operator">=</span><span class="token variable">${NAME_3}</span>
<span class="token assign-left variable">THIS_IP</span><span class="token operator">=</span><span class="token variable">${HOST_3}</span>
docker run --name etcd -d <span class="token punctuation">\</span>
  -p <span class="token number">2379</span>:2379 <span class="token punctuation">\</span>
  -p <span class="token number">2380</span>:2380 <span class="token punctuation">\</span>
  --env <span class="token assign-left variable">ALLOW_NONE_AUTHENTICATION</span><span class="token operator">=</span>yes <span class="token punctuation">\</span>
  --env <span class="token assign-left variable">ETCD_LISTEN_CLIENT_URLS</span><span class="token operator">=</span>http://0.0.0.0:2379 <span class="token punctuation">\</span>
  --env <span class="token assign-left variable">ETCD_ADVERTISE_CLIENT_URLS</span><span class="token operator">=</span>http://<span class="token variable">${THIS_IP}</span>:2379 <span class="token punctuation">\</span>
  <span class="token variable">${REGISTRY}</span><span class="token builtin class-name">:</span><span class="token variable">${ETCD_VERSION}</span> <span class="token punctuation">\</span>
   etcd <span class="token punctuation">\</span>
    --name <span class="token variable">${THIS_NAME}</span> <span class="token punctuation">\</span>
    --initial-advertise-peer-urls http://<span class="token variable">${THIS_IP}</span>:2380 --listen-peer-urls http://0.0.0.0:2380 <span class="token punctuation">\</span>
  	--discovery <span class="token variable">${DISCOVERY}</span> <span class="token punctuation">\</span>
  	--initial-cluster-state <span class="token variable">${CLUSTER_STATE}</span> --initial-cluster-token <span class="token variable">${TOKEN}</span>
</code></pre></div><h3 id="åŸºäº-dns-éƒ¨ç½²" tabindex="-1"><a class="header-anchor" href="#åŸºäº-dns-éƒ¨ç½²" aria-hidden="true">#</a> åŸºäº DNS éƒ¨ç½²</h3><p>ç¼–è¾‘ DNS æœåŠ¡å™¨çš„ <code>/etc/dnsmasq.conf</code>ï¼š</p><div class="language-bash ext-sh"><pre class="language-bash"><code><span class="token comment"># etcd åŠ¨æ€å‘ç°</span>
srv-host<span class="token operator">=</span>_etcd-server._tcp.example.com,etcd1.example.com,2380,0,100
srv-host<span class="token operator">=</span>_etcd-server._tcp.example.com,etcd2.example.com,2380,0,100
srv-host<span class="token operator">=</span>_etcd-server._tcp.example.com,etcd3.example.com,2380,0,100
</code></pre></div><p>å†åœ¨ <code>/etc/dnsmasq.hosts</code> å¢åŠ è§£æï¼š</p><div class="language-bash ext-sh"><pre class="language-bash"><code><span class="token number">10.0</span>.0.137 etcd1.example.com
<span class="token number">10.0</span>.0.138 etcd2.example.com
<span class="token number">10.0</span>.0.139 etcd3.example.com
</code></pre></div><p>åœ¨æ¯å°æœåŠ¡å™¨ä¸ŠæŒ‡å®š DNS åéªŒè¯è§£æï¼š</p><div class="language-bash ext-sh"><pre class="language-bash"><code><span class="token function">dig</span> +noall +answer SRV _etcd-server._tcp.example.com
</code></pre></div><p>æ­¤å¤„ä»…ä»¥ <code>node1</code> ç¤ºä¾‹ï¼Œæ³¨ etcd æ–°ç‰ˆæœ¬<a href="https://github.com/etcd-io/etcd/issues/11321" target="_blank" rel="noopener noreferrer">éœ€è¦ HTTPS<span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" ariahidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span></a>ï¼Œæ‰€ä»¥åˆ‡æ¢ä¸ºæ—§ç‰ˆï¼š</p><div class="language-bash ext-sh"><pre class="language-bash"><code>docker stop etcd <span class="token operator">&amp;&amp;</span> docker <span class="token function">rm</span> etcd
<span class="token assign-left variable">ETCD_VERSION</span><span class="token operator">=</span><span class="token number">3.3</span>.15
<span class="token assign-left variable">THIS_NAME</span><span class="token operator">=</span><span class="token variable">${NAME_1}</span>
<span class="token assign-left variable">THIS_URLS</span><span class="token operator">=</span>etcd1.example.com
docker run --name etcd -d <span class="token punctuation">\</span>
  -p <span class="token number">2379</span>:2379 <span class="token punctuation">\</span>
  -p <span class="token number">2380</span>:2380 <span class="token punctuation">\</span>
  --env <span class="token assign-left variable">ALLOW_NONE_AUTHENTICATION</span><span class="token operator">=</span>yes <span class="token punctuation">\</span>
  --env <span class="token assign-left variable">ETCD_DISCOVERY_SRV</span><span class="token operator">=</span>example.com <span class="token punctuation">\</span>
  --env <span class="token assign-left variable">ETCD_LISTEN_CLIENT_URLS</span><span class="token operator">=</span>http://0.0.0.0:2379 <span class="token punctuation">\</span>
  --env <span class="token assign-left variable">ETCD_ADVERTISE_CLIENT_URLS</span><span class="token operator">=</span>http://<span class="token variable">${THIS_URLS}</span>:2379 <span class="token punctuation">\</span>
  <span class="token variable">${REGISTRY}</span><span class="token builtin class-name">:</span><span class="token variable">${ETCD_VERSION}</span> <span class="token punctuation">\</span>
   etcd <span class="token punctuation">\</span>
    --name <span class="token variable">${THIS_NAME}</span> <span class="token punctuation">\</span>
    --initial-advertise-peer-urls http://<span class="token variable">${THIS_URLS}</span>:2380 --listen-peer-urls http://0.0.0.0:2380 <span class="token punctuation">\</span>
  	--initial-cluster-state <span class="token variable">${CLUSTER_STATE}</span> --initial-cluster-token <span class="token variable">${TOKEN}</span>
</code></pre></div><h3 id="æ ¡éªŒç»“æœ" tabindex="-1"><a class="header-anchor" href="#æ ¡éªŒç»“æœ" aria-hidden="true">#</a> æ ¡éªŒç»“æœ</h3><p>æŸ¥çœ‹é›†ç¾¤æˆå‘˜ï¼š</p><div class="language-bash ext-sh"><pre class="language-bash"><code>docker <span class="token builtin class-name">exec</span> -it etcd etcdctl member list

<span class="token comment"># å¾—åˆ°</span>
c45dc290bba2bf1, started, etcd-n1, http://10.0.0.137:2380, http://10.0.0.137:2379, <span class="token boolean">false</span>
26788b649bce5709, started, etcd-n2, http://10.0.0.138:2380, http://10.0.0.138:2379, <span class="token boolean">false</span>
510527ca792cc2da, started, etcd-n3, http://10.0.0.139:2380, http://10.0.0.139:2379, <span class="token boolean">false</span>
</code></pre></div><p>æŸ¥çœ‹å¥åº·çŠ¶æ€ï¼š</p><div class="language-bash ext-sh"><pre class="language-bash"><code>docker <span class="token builtin class-name">exec</span> -it etcd etcdctl --write-out<span class="token operator">=</span>table --endpoints<span class="token operator">=</span><span class="token string">&quot;http://10.0.0.137:2379,http://10.0.0.138:2379,http://10.0.0.139:2379&quot;</span> endpoint  health

<span class="token comment"># å¾—åˆ°</span>
http://10.0.0.138:2379 is healthy: successfully committed proposal: took <span class="token operator">=</span> <span class="token number">11</span>.12227ms
http://10.0.0.139:2379 is healthy: successfully committed proposal: took <span class="token operator">=</span> <span class="token number">11</span>.674569ms
http://10.0.0.137:2379 is healthy: successfully committed proposal: took <span class="token operator">=</span> <span class="token number">11</span>.993285ms


docker <span class="token builtin class-name">exec</span> -it etcd etcdctl --write-out<span class="token operator">=</span>table --endpoints<span class="token operator">=</span><span class="token string">&quot;http://etcd1.example.com:2379,http://etcd2.example.com:2379,http://etcd3.example.com:2379&quot;</span> endpoint  health

<span class="token comment"># å¾—åˆ°</span>
+--------------------------+--------+------------+-------+
<span class="token operator">|</span>         ENDPOINT         <span class="token operator">|</span> HEALTH <span class="token operator">|</span>    TOOK    <span class="token operator">|</span> ERROR <span class="token operator">|</span>
+--------------------------+--------+------------+-------+
<span class="token operator">|</span> http://etcd1.example.com:2379 <span class="token operator">|</span>   <span class="token boolean">true</span> <span class="token operator">|</span> <span class="token number">8</span>.615217ms <span class="token operator">|</span>       <span class="token operator">|</span>
<span class="token operator">|</span> http://etcd3.example.com:2379 <span class="token operator">|</span>   <span class="token boolean">true</span> <span class="token operator">|</span>  <span class="token number">8</span>.97122ms <span class="token operator">|</span>       <span class="token operator">|</span>
<span class="token operator">|</span> http://etcd2.example.com:2379 <span class="token operator">|</span>   <span class="token boolean">true</span> <span class="token operator">|</span> <span class="token number">9</span>.323943ms <span class="token operator">|</span>       <span class="token operator">|</span>
+--------------------------+--------+------------+-------+
</code></pre></div><h2 id="æ•°æ®" tabindex="-1"><a class="header-anchor" href="#æ•°æ®" aria-hidden="true">#</a> æ•°æ®</h2><h3 id="crud" tabindex="-1"><a class="header-anchor" href="#crud" aria-hidden="true">#</a> CRUD</h3><p><code>node1</code> è®¾ç½®ï¼š</p><div class="language-bash ext-sh"><pre class="language-bash"><code>docker <span class="token builtin class-name">exec</span> -it etcd etcdctl put /testdir/testkey <span class="token string">&quot;Hello world&quot;</span>
</code></pre></div><p><code>node3</code> è¯»å–ï¼š</p><div class="language-bash ext-sh"><pre class="language-bash"><code>docker <span class="token builtin class-name">exec</span> -it etcd etcdctl get /testdir/testkey

<span class="token comment"># å¾—åˆ°</span>
/testdir/testkey
Hello world
</code></pre></div><h3 id="watch" tabindex="-1"><a class="header-anchor" href="#watch" aria-hidden="true">#</a> WATCH</h3><p><code>node2</code> ç›‘å¬ï¼š</p><div class="language-bash ext-sh"><pre class="language-bash"><code>docker <span class="token builtin class-name">exec</span> -it etcd etcdctl <span class="token function">watch</span> hi 
</code></pre></div><p><code>node3</code> è®¾ç½®ï¼š</p><div class="language-bash ext-sh"><pre class="language-bash"><code>docker <span class="token builtin class-name">exec</span> -it etcd etcdctl put hi shanyuhai
</code></pre></div><p><code>node2</code> ä¼šå¾—åˆ°å“åº”ï¼š</p><div class="language-bash ext-sh"><pre class="language-bash"><code>PUT
hi
shanyuhai
</code></pre></div><h2 id="å¤„ç†é—®é¢˜" tabindex="-1"><a class="header-anchor" href="#å¤„ç†é—®é¢˜" aria-hidden="true">#</a> å¤„ç†é—®é¢˜</h2><div class="language-bash ext-sh"><pre class="language-bash"><code>docker logs etcd
</code></pre></div><table><thead><tr><th>æ—¥å¿—</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td><code>health check for peer xxx could not connect: dial tcp IP:2380: getsockopt: connection refused</code></td><td>æ— æ³•å»ºç«‹ä¸è¿™ä¸ª IP çš„ 2380 ç«¯å£è¿›è¡Œè¿æ¥ã€‚æ£€æŸ¥ etcd å®¹å™¨æ˜¯å¦åœ¨é‚£ä¸ª IP çš„ä¸»æœºä¸Šè¿è¡Œã€‚</td></tr><tr><td><code>xxx is starting a new election at term x</code></td><td>etcd é›†ç¾¤å·²ç»å¤±å»äº†æ³•å®šäººæ•°ï¼Œæ­£åœ¨å°è¯•å»ºç«‹æ–°çš„é¢†å¯¼è€…ã€‚å½“å¤§å¤šæ•°è¿è¡Œ etcd çš„èŠ‚ç‚¹å‡ºç°æ•…éšœæˆ–æ— æ³•è®¿é—®æ—¶ï¼Œå¯èƒ½ä¼šå‘ç”Ÿè¿™ç§æƒ…å†µã€‚</td></tr><tr><td><code>connection error: desc = &quot;transport: Error while dialing dial tcp 0.0.0.0:2379: i/o timeout&quot;; Reconnecting to {0.0.0.0:2379 0 &lt;nil&gt;}</code></td><td>ä¸»æœºé˜²ç«å¢™é˜»æ­¢äº†ç½‘ç»œé€šä¿¡ã€‚</td></tr><tr><td><code>rafthttp: request cluster ID mismatch</code></td><td>è¿è¡Œç€ etcd å®ä¾‹å¹¶è®°å½•<code>rafthttp: request cluster ID mismatch</code>çš„èŠ‚ç‚¹æ­£åœ¨å°è¯•åŠ å…¥å¦ä¸€ä¸ªç”±å…¶ä»–æˆå‘˜æ„æˆçš„é›†ç¾¤ã€‚åº”è¯¥ä»é›†ç¾¤ä¸­åˆ é™¤è¿™ä¸ªèŠ‚ç‚¹ï¼Œç„¶åé‡æ–°æ·»åŠ ã€‚</td></tr><tr><td><code>rafthttp: failed to find member</code></td><td>é›†ç¾¤çŠ¶æ€ (<code>/var/lib/etcd</code>) åŒ…å«é”™è¯¯ä¿¡æ¯ï¼Œæ— æ³•åŠ å…¥é›†ç¾¤ã€‚åº”è¯¥ä»é›†ç¾¤ä¸­åˆ é™¤è¿™ä¸ªèŠ‚ç‚¹ï¼Œå¹¶åˆ é™¤çŠ¶æ€ç›®å½•ï¼Œç„¶åé‡æ–°æ·»åŠ ã€‚</td></tr></tbody></table><!--]--></div><footer class="page-meta"><div class="meta-item edit-link"><a class="nav-link external meta-item-label" href="https://github.com/shanyuhai123/documents/edit/master/docs/backend/docker/etcd.md" rel="noopener noreferrer" target="_blank" aria-label="ç¼–è¾‘æ–‡æ¡£ï¼"><!--[--><!--]--> ç¼–è¾‘æ–‡æ¡£ï¼ <span><svg class="icon outbound" xmlns="http://www.w3.org/2000/svg" ariahidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><!--[--><span class="sr-only">open in new window</span><!--]--></span><!--[--><!--]--></a></div><div class="meta-item last-updated"><span class="meta-item-label">ä¸Šæ¬¡æ›´æ–°: </span><span class="meta-item-info">2021/7/22 ä¸Šåˆ12:30:40</span></div><!----></footer><nav class="page-nav"><p class="inner"><span class="prev"> â† <a href="/backend/docker/docker-compose.html" class="nav-link" aria-label="Docker Compose ç®¡ç†å¤šä¸ªæœåŠ¡"><!--[--><!--]--> Docker Compose ç®¡ç†å¤šä¸ªæœåŠ¡ <!--[--><!--]--></a></span><span class="next"><a href="/backend/docker/private-registry.html" class="nav-link" aria-label="ä½¿ç”¨ Harbor æ„å»ºç§æœ‰é•œåƒä»“åº“"><!--[--><!--]--> ä½¿ç”¨ Harbor æ„å»ºç§æœ‰é•œåƒä»“åº“ <!--[--><!--]--></a> â†’ </span></p></nav><!--[--><!--]--></main><!--]--></div><!----><!----><!--]--></div>
    <script type="module" src="/assets/app.a242ecf4.js" defer></script>
  </body>
</html>
