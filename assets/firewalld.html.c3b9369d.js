import{r as e,c as o,a as s,b as p,F as r,e as n,d as a,o as c}from"./app.915a3542.js";import{_ as l}from"./plugin-vue_export-helper.5a098b48.js";const d={},i=n(`<h1 id="\u9632\u706B\u5899-firewalld" tabindex="-1"><a class="header-anchor" href="#\u9632\u706B\u5899-firewalld" aria-hidden="true">#</a> \u9632\u706B\u5899 firewalld</h1><p>firewalld \u662F CentOS 7 \u65B0\u589E\u7684\u7279\u6027\uFF0C\u5176\u652F\u6301\u52A8\u6001\u66F4\u65B0\uFF0C\u4E14\u6DFB\u52A0\u4E86\u9632\u706B\u5899 &quot;zones&quot; \u7684\u6982\u5FF5\u3002</p><p>firewalld \u4E0E iptables \u81EA\u8EAB\u5E76\u4E0D\u5177\u5907\u9632\u706B\u5899\u7684\u529F\u80FD\uFF0C\u90FD\u9700\u8981\u901A\u8FC7\u5185\u6838\u7684 netfilter \u6765\u5B9E\u73B0\uFF0C\u5B83\u4EEC\u7684\u4F5C\u7528\u90FD\u662F\u7EF4\u62A4\u8FC7\u6EE4\u7684\u89C4\u5219\u3002</p><p>firewalld \u7684\u914D\u7F6E\u6587\u4EF6\u5B58\u653E\u5728 <code>/usr/lib/firewalld/</code> \u548C <code>/etc/firewalld/</code> \u91CC\u7684 XML \u6587\u4EF6\u4E2D\u3002</p><div class="language-bash ext-sh"><pre class="language-bash"><code><span class="token comment"># \u5B89\u88C5</span>
yum <span class="token function">install</span> firewalld firewall-config
</code></pre></div><h2 id="\u6307\u4EE4" tabindex="-1"><a class="header-anchor" href="#\u6307\u4EE4" aria-hidden="true">#</a> \u6307\u4EE4</h2><blockquote><p>\u53EF\u80FD\u9700\u8981\u5148\u4F7F\u7528 systemctl \u5957\u4EF6\u542F\u7528\u670D\u52A1\u3002</p><p>\u9664\u4E86\u4F7F\u7528\u547D\u4EE4\u683C\u5F0F\u5916\uFF0C\u8FD8\u53EF\u4EE5\u4F7F\u7528 GUI\uFF0C\u4E0D\u8FC7\u9700\u8981\u6CE8\u610F\u7684\u662F\u5728\u767B\u5F55\u65F6\u9700\u8981 <code>ssh -Y user@ip</code> \u3002</p></blockquote><div class="custom-container danger"><p class="custom-container-title">DANGER</p><p>firewall-cmd [Options ... ]</p></div><h3 id="_1-\u72B6\u6001\u9009\u9879" tabindex="-1"><a class="header-anchor" href="#_1-\u72B6\u6001\u9009\u9879" aria-hidden="true">#</a> 1. \u72B6\u6001\u9009\u9879</h3><table><thead><tr><th>option</th><th>effect</th></tr></thead><tbody><tr><td>--state</td><td>firewalld \u7684\u72B6\u6001\u3002</td></tr><tr><td>--reload</td><td>\u4E0D\u4E2D\u65AD\u670D\u52A1\u7684\u91CD\u65B0\u52A0\u8F7D\u3002</td></tr><tr><td>--complete-reload</td><td>\u4E2D\u65AD\u6240\u6709\u8FDE\u63A5\u7684\u91CD\u65B0\u52A0\u8F7D\u3002</td></tr><tr><td>--runtime-to-permanent</td><td>\u5C06\u5F53\u524D\u9632\u706B\u5899\u7684\u89C4\u5219\u6C38\u4E45\u4FDD\u5B58\u3002</td></tr><tr><td>--check-config</td><td>\u68C0\u67E5\u914D\u7F6E\u6B63\u786E\u6027\u3002</td></tr></tbody></table><h3 id="_2-\u65E5\u5FD7\u9009\u9879" tabindex="-1"><a class="header-anchor" href="#_2-\u65E5\u5FD7\u9009\u9879" aria-hidden="true">#</a> 2. \u65E5\u5FD7\u9009\u9879</h3><table><thead><tr><th>option</th><th>effect</th></tr></thead><tbody><tr><td>--get-log-denied</td><td>\u83B7\u53D6\u8BB0\u5F55\u88AB\u62D2\u7EDD\u7684\u65E5\u5FD7\u3002</td></tr><tr><td>--set-log-denied=value</td><td>\u8BBE\u7F6E\u8BB0\u5F55\u88AB\u62D2\u7EDD\u7684\u65E5\u5FD7\uFF0C\u53EA\u80FD\u4E3A &#39;all&#39;,&#39;unicast&#39;,&#39;broadcast&#39;,&#39;multicast&#39;,&#39;off&#39; \u5176\u4E2D\u7684\u4E00\u4E2A\u3002</td></tr></tbody></table><h2 id="\u64CD\u4F5C" tabindex="-1"><a class="header-anchor" href="#\u64CD\u4F5C" aria-hidden="true">#</a> \u64CD\u4F5C</h2><p>\u5728\u5F00\u59CB\u64CD\u4F5C\u524D\u9700\u8981\u5BF9 zone \u6709\u4E00\u5B9A\u7684\u4E86\u89E3\u3002</p><table><thead><tr><th>zone</th><th>zh</th><th>effect</th></tr></thead><tbody><tr><td>drop</td><td>\u4E22\u5F03</td><td>\u4EFB\u4F55\u63A5\u6536\u7684\u7F51\u7EDC\u6570\u636E\u5305\u90FD\u88AB\u4E22\u5F03\uFF0C\u6CA1\u6709\u4EFB\u4F55\u56DE\u590D\u3002\u4EC5\u80FD\u6709\u53D1\u9001\u51FA\u53BB\u7684\u7F51\u7EDC\u8FDE\u63A5\u3002</td></tr><tr><td>block</td><td>\u9650\u5236</td><td>\u4EFB\u4F55\u63A5\u6536\u7684\u7F51\u7EDC\u8FDE\u63A5\u90FD\u88AB <code>IPv4</code> \u7684 icmp-host-prohibited \u4FE1\u606F\u548C <code>IPv6</code> \u7684 icmp6-adm-prohibited \u4FE1\u606F\u6240\u62D2\u7EDD\u3002</td></tr><tr><td>public</td><td>\u516C\u5171</td><td>\u5728\u516C\u5171\u533A\u57DF\u5185\u4F7F\u7528\uFF0C\u4E0D\u80FD\u76F8\u4FE1\u7F51\u7EDC\u5185\u7684\u5176\u4ED6\u8BA1\u7B97\u673A\u4E0D\u4F1A\u5BF9\u60A8\u7684\u8BA1\u7B97\u673A\u9020\u6210\u5371\u5BB3\uFF0C\u53EA\u80FD\u63A5\u6536\u7ECF\u8FC7\u9009\u53D6\u7684\u8FDE\u63A5\u3002</td></tr><tr><td>external</td><td>\u5916\u90E8</td><td>\u7279\u522B\u662F\u4E3A\u8DEF\u7531\u5668\u542F\u7528\u4E86\u4F2A\u88C5\u529F\u80FD\u7684\u5916\u90E8\u7F51\u3002\u60A8\u4E0D\u80FD\u4FE1\u4EFB\u6765\u81EA\u7F51\u7EDC\u7684\u5176\u4ED6\u8BA1\u7B97\uFF0C\u4E0D\u80FD\u76F8\u4FE1\u5B83\u4EEC\u4E0D\u4F1A\u5BF9\u60A8\u7684\u8BA1\u7B97\u673A\u9020\u6210\u5371\u5BB3\uFF0C\u53EA\u80FD\u63A5\u6536\u7ECF\u8FC7\u9009\u62E9\u7684\u8FDE\u63A5\u3002</td></tr><tr><td>dmz</td><td>\u975E\u519B\u4E8B\u533A</td><td>\u7528\u4E8E\u60A8\u7684\u975E\u519B\u4E8B\u533A\u5185\u7684\u7535\u8111\uFF0C\u6B64\u533A\u57DF\u5185\u53EF\u516C\u5F00\u8BBF\u95EE\uFF0C\u53EF\u4EE5\u6709\u9650\u5730\u8FDB\u5165\u60A8\u7684\u5185\u90E8\u7F51\u7EDC\uFF0C\u4EC5\u4EC5\u63A5\u6536\u7ECF\u8FC7\u9009\u62E9\u7684\u8FDE\u63A5\u3002</td></tr><tr><td>work</td><td>\u5DE5\u4F5C</td><td>\u7528\u4E8E\u5DE5\u4F5C\u533A\u3002\u60A8\u53EF\u4EE5\u57FA\u672C\u76F8\u4FE1\u7F51\u7EDC\u5185\u7684\u5176\u4ED6\u7535\u8111\u4E0D\u4F1A\u5371\u5BB3\u60A8\u7684\u7535\u8111\u3002\u4EC5\u4EC5\u63A5\u6536\u7ECF\u8FC7\u9009\u62E9\u7684\u8FDE\u63A5\u3002</td></tr><tr><td>home</td><td>\u5BB6\u5EAD</td><td>\u7528\u4E8E\u5BB6\u5EAD\u7F51\u7EDC\u3002\u60A8\u53EF\u4EE5\u57FA\u672C\u4FE1\u4EFB\u7F51\u7EDC\u5185\u7684\u5176\u4ED6\u8BA1\u7B97\u673A\u4E0D\u4F1A\u5371\u5BB3\u60A8\u7684\u8BA1\u7B97\u673A\u3002\u4EC5\u4EC5\u63A5\u6536\u7ECF\u8FC7\u9009\u62E9\u7684\u8FDE\u63A5\u3002</td></tr><tr><td>internal</td><td>\u5185\u90E8</td><td>\u7528\u4E8E\u5185\u90E8\u7F51\u7EDC\u3002\u60A8\u53EF\u4EE5\u57FA\u672C\u4E0A\u4FE1\u4EFB\u7F51\u7EDC\u5185\u7684\u5176\u4ED6\u8BA1\u7B97\u673A\u4E0D\u4F1A\u5A01\u80C1\u60A8\u7684\u8BA1\u7B97\u673A\u3002\u4EC5\u4EC5\u63A5\u53D7\u7ECF\u8FC7\u9009\u62E9\u7684\u8FDE\u63A5\u3002</td></tr><tr><td>trusted</td><td>\u4FE1\u4EFB</td><td>\u53EF\u63A5\u53D7\u6240\u6709\u7684\u7F51\u7EDC\u8FDE\u63A5\u3002</td></tr></tbody></table><p><code>firewalld</code> \u91CC\u7684\u9ED8\u8BA4\u533A\u57DF\u88AB\u8BBE\u5B9A\u4E3A\u516C\u5171\u533A\u57DF\u3002</p><h3 id="_1-service" tabindex="-1"><a class="header-anchor" href="#_1-service" aria-hidden="true">#</a> 1. service</h3><div class="language-bash ext-sh"><pre class="language-bash"><code><span class="token comment"># \u663E\u793A\u652F\u6301\u7684 zone \u5217\u8868\uFF1A</span>
firewall-cmd --get-zones
<span class="token comment"># \u67E5\u770B\u6240\u6709 zone \u8BE6\u60C5\uFF1A</span>
firewall-cmd --list-all-zones
<span class="token comment"># \u67E5\u770B\u67D0\u4E00 zone \u8BE6\u60C5\uFF1A</span>
firewall-cmd --zone<span class="token operator">=</span>public --list-all
<span class="token comment"># \u67E5\u770B\u9ED8\u8BA4 zone\uFF1A</span>
firewall-cmd --get-default-zone
<span class="token comment"># \u663E\u793A\u6240\u6709 services\uFF1A</span>
firewall-cmd --get-services
<span class="token comment"># \u67E5\u770B\u67D0\u4E00\u670D\u52A1\uFF08\u8FD4\u56DE yes/no\uFF09\uFF1A</span>
firewall-cmd --query-service<span class="token operator">=</span><span class="token operator">&lt;</span>service name<span class="token operator">&gt;</span>
firewall-cmd --query-service<span class="token operator">=</span>http <span class="token comment"># no / 80</span>
<span class="token comment"># \u663E\u793A\u5F53\u524D service\uFF1A</span>
firewall-cmd --list-services
<span class="token comment"># \u6DFB\u52A0\u670D\u52A1\uFF1A</span>
firewall-cmd --add-service<span class="token operator">=</span><span class="token operator">&lt;</span>service name<span class="token operator">&gt;</span>
<span class="token comment"># \u5220\u9664\u670D\u52A1\uFF1A</span>
firewall-cmd --remove-service<span class="token operator">=</span><span class="token operator">&lt;</span>service name<span class="token operator">&gt;</span>
<span class="token comment"># \u5141\u8BB8SSH\u670D\u52A1\u901A\u8FC7\uFF1A</span>
firewall-cmd --enable <span class="token assign-left variable">service</span><span class="token operator">=</span>ssh
<span class="token comment"># \u7981\u6B62SSH\u670D\u52A1\u901A\u8FC7\uFF1A</span>
firewall-cmd --disable <span class="token assign-left variable">service</span><span class="token operator">=</span>ssh
<span class="token comment"># \u6DFB\u52A0\u670D\u52A1\u81F3 zone\uFF1A</span>
firewall-cmd --zone<span class="token operator">=</span>public --add-service<span class="token operator">=</span><span class="token operator">&lt;</span>service name<span class="token operator">&gt;</span> --permanent
</code></pre></div><h3 id="_2-port" tabindex="-1"><a class="header-anchor" href="#_2-port" aria-hidden="true">#</a> 2. port</h3><div class="language-bash ext-sh"><pre class="language-bash"><code><span class="token comment"># \u67E5\u770B\u6240\u6709\u7AEF\u53E3\uFF1A</span>
firewall-cmd --list-port
<span class="token comment"># \u67E5\u770B\u67D0\u4E2A\u7AEF\u53E3\uFF1A</span>
firewall-cmd --query-port<span class="token operator">=</span><span class="token number">22</span>/tcp
<span class="token comment"># \u6DFB\u52A0\u67D0\u4E2A\u7AEF\u53E3\uFF1A</span>
firewall-cmd --add-port<span class="token operator">=</span><span class="token number">22</span>/tcp --permanent  
<span class="token comment"># \u5220\u9664\u67D0\u4E2A\u7AEF\u53E3\uFF1A</span>
firewall-cmd --remove-port<span class="token operator">=</span><span class="token number">22</span>/tcp

<span class="token comment"># \u5C06 80 \u7AEF\u53E3\u7684\u6D41\u91CF\u8F6C\u53D1\u81F3 8080\uFF1A</span>
firewall-cmd --add-forward-port<span class="token operator">=</span>port<span class="token operator">=</span><span class="token number">80</span>:proto<span class="token operator">=</span>tcp:toport<span class="token operator">=</span><span class="token number">8080</span>   
</code></pre></div><h3 id="_3-ip" tabindex="-1"><a class="header-anchor" href="#_3-ip" aria-hidden="true">#</a> 3. IP</h3><div class="language-bash ext-sh"><pre class="language-bash"><code><span class="token comment"># \u68C0\u67E5\u662F\u5426\u5141\u8BB8\u4F2A\u88C5 IP\uFF1A</span>
firewall-cmd --query-masquerade
<span class="token comment"># \u5141\u8BB8\u9632\u706B\u5899\u4F2A\u88C5 IP\uFF1A</span>
firewall-cmd --add-masquerade
<span class="token comment"># \u7981\u6B62\u9632\u706B\u5899\u4F2A\u88C5 IP\uFF1A</span>
firewall-cmd --remove-masquerade

<span class="token comment"># \u5C01\u7981\u67D0\u4E2A IP\uFF1A</span>
firewall-cmd --permanent --add-rich-rule<span class="token operator">=</span><span class="token string">&#39;rule family=ipv4 source address=&quot;ip&quot; drop&#39;</span>
</code></pre></div><h3 id="_4-rich-rule" tabindex="-1"><a class="header-anchor" href="#_4-rich-rule" aria-hidden="true">#</a> 4. rich-rule</h3>`,23),u=a("\u591A\u89C4\u5219\u547D\u4EE4\u7684\u683C\u5F0F\u6216\u7ED3\u6784\u5982\u4E0B\uFF08\u53CA"),h={href:"https://access.redhat.com/documentation/zh_cn/red_hat_enterprise_linux/7/html/security_guide/sec-using_firewalls#Configuring_Complex_Firewall_Rules_with_the_Rich-Language_Syntax",target:"_blank",rel:"noopener noreferrer"},m=a("\u89E3\u91CA"),k=a("\uFF09\uFF1A"),f=n(`<div class="language-bash ext-sh"><pre class="language-bash"><code>rule <span class="token punctuation">[</span>family<span class="token operator">=</span><span class="token string">&quot;&lt;rule family&gt;&quot;</span><span class="token punctuation">]</span>
    <span class="token punctuation">[</span> <span class="token builtin class-name">source</span> <span class="token assign-left variable">address</span><span class="token operator">=</span><span class="token string">&quot;&lt;address&gt;&quot;</span> <span class="token punctuation">[</span>invert<span class="token operator">=</span><span class="token string">&quot;True&quot;</span><span class="token punctuation">]</span> <span class="token punctuation">]</span>
    <span class="token punctuation">[</span> destination <span class="token assign-left variable">address</span><span class="token operator">=</span><span class="token string">&quot;&lt;address&gt;&quot;</span> <span class="token punctuation">[</span>invert<span class="token operator">=</span><span class="token string">&quot;True&quot;</span><span class="token punctuation">]</span> <span class="token punctuation">]</span>
    <span class="token punctuation">[</span> <span class="token operator">&lt;</span>element<span class="token operator">&gt;</span> <span class="token punctuation">]</span>
    <span class="token punctuation">[</span> log <span class="token punctuation">[</span>prefix<span class="token operator">=</span><span class="token string">&quot;&lt;prefix text&gt;&quot;</span><span class="token punctuation">]</span> <span class="token punctuation">[</span>level<span class="token operator">=</span><span class="token string">&quot;&lt;log level&gt;&quot;</span><span class="token punctuation">]</span> <span class="token punctuation">[</span>limit <span class="token assign-left variable">value</span><span class="token operator">=</span><span class="token string">&quot;rate/duration&quot;</span><span class="token punctuation">]</span> <span class="token punctuation">]</span>
    <span class="token punctuation">[</span> audit <span class="token punctuation">]</span>
    <span class="token punctuation">[</span> accept<span class="token operator">|</span>reject<span class="token operator">|</span>drop <span class="token punctuation">]</span>
</code></pre></div>`,1);function g(b,_){const t=e("OutboundLink");return c(),o(r,null,[i,s("p",null,[u,s("a",h,[m,p(t)]),k]),f],64)}var q=l(d,[["render",g]]);export{q as default};
